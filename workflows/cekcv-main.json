{
  "name": "CekCV.Ai (2) - For Claude Code",
  "nodes": [
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        1664,
        1616
      ],
      "id": "70059c94-88e8-4f53-a9cc-4419055868bb",
      "name": "No Action1"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.toolCalculator",
      "typeVersion": 1,
      "position": [
        3344,
        1824
      ],
      "id": "f1cea334-fb53-49b3-b80d-151d7349eef6",
      "name": "Calculator1"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"cvText\": {{ JSON.stringify($('Document Data').item.json.concatenated_data) }},\n  \"jobDescription\": {{ JSON.stringify($('Parse Company Input').first().json.jobDescription || '') }},\n  \"priorityWeights\": {{ JSON.stringify($('Parse Company Input').first().json.priorityWeights || '{\"TechnicalSkills\":8,\"RelevantWorkExperience\":8,\"EducationalBackground\":3,\"Certifications\":1,\"LocationOrWorkAuth\":1}') }},\n  \"roleName\": {{ JSON.stringify($('Parse Company Input').first().json.roleName || '') }},\n  \"senderEmail\": {{ JSON.stringify($('Binary Extractor').item.json.senderEmail || 'webapp') }},\n  \"fileName\": {{ JSON.stringify($('Binary Extractor').item.json.fileName || '') }}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1840,
        1424
      ],
      "id": "cb279469-eef9-4851-a7bf-4b7e68c1ffd4",
      "name": "Merge Config"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "={{ $json.cvText }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=Extract the following structured information from the provided resume text. Output MUST be valid JSON matching the schema exactly.\n\nIf any information is missing, use empty string \"\" for strings, empty array [] for arrays.\n\n{{ $json?.feedback\n  ? `<feedback>Previous extraction had issues: ${$json.feedback}. Current data: ${JSON.stringify($json.extractedResume)}. Please fix.</feedback>`\n  : ''\n}}\n\nOutput JSON Schema:\n{\n  \"personal\": {\"name\":\"\",\"email\":\"\",\"phone\":\"\",\"location\":\"\",\"links\":[]},\n  \"summary\":\"\",\n  \"experience\":[{\"title\":\"\",\"company\":\"\",\"start\":\"\",\"end\":\"\",\"highlights\":[]}],\n  \"education\":[{\"school\":\"\",\"degree\":\"\",\"field\":\"\",\"gradYear\":\"\"}],\n  \"skills\":{\"hard\":[],\"soft\":[]},\n  \"certifications\":[],\n  \"projects\":[]\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        2016,
        1424
      ],
      "id": "4ebe2851-f28f-4c58-9078-fe17fb0bb5e3",
      "name": "Resume Data Extractor",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=<extractedResume>\n{{ JSON.stringify($json.output) }}\n</extractedResume>\n\n<originalResumeText>\n{{ $('Merge Config').item.json.cvText }}\n</originalResumeText>",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=Carefully compare the extracted resume information with the original resume text. Verify that all essential sections are captured accurately.\n\nCheck:\n- Personal Information (name, email, phone, links, location)\n- Summary\n- Experience (title, company, dates, highlights)\n- Education\n- Skills (hard & soft)\n- Certifications\n- Projects\n\nEvaluation Criteria:\n- Completeness: All info must be captured\n- Accuracy: Must match original\n- No Hallucination: No invented data\n\nIMPORTANT: You MUST respond ONLY with valid JSON matching one of these formats, no other text:\nIf pass: {\"pass\": true, \"feedback\": \"\"}\nIf fail: {\"pass\": false, \"feedback\": \"Concise actionable suggestions\"}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        2320,
        1424
      ],
      "id": "ccdab322-c210-4ec3-b517-2a0ac026b8d2",
      "name": "Evaluator",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        2016,
        1664
      ],
      "id": "888cc0be-75cc-48a6-b727-35b9e67d5e46",
      "name": "LLM Extractor",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"personal\": {\"name\":\"John Doe\",\"email\":\"john@email.com\",\"phone\":\"+62812xxx\",\"location\":\"Jakarta, Indonesia\",\"links\":[\"linkedin.com/in/johndoe\"]},\n  \"summary\":\"Experienced developer...\",\n  \"experience\":[{\"title\":\"Software Engineer\",\"company\":\"PT ABC\",\"start\":\"2020-01\",\"end\":\"2023-12\",\"highlights\":[\"Led team of 5\"]}],\n  \"education\":[{\"school\":\"Universitas Indonesia\",\"degree\":\"S1\",\"field\":\"Informatika\",\"gradYear\":\"2020\"}],\n  \"skills\":{\"hard\":[\"Python\",\"React\"],\"soft\":[\"Leadership\"]},\n  \"certifications\":[\"AWS Certified\"],\n  \"projects\":[\"E-commerce Platform\"]\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        2176,
        1664
      ],
      "id": "d94bd263-c54e-4f05-96c5-733030acf371",
      "name": "Resume Parser Output"
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.6",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        2320,
        1664
      ],
      "id": "af764c24-28d5-44cd-a1ac-76feaec480eb",
      "name": "LLM Evaluator",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"pass\": true,\n  \"feedback\": \"\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        2480,
        1664
      ],
      "id": "99826282-670b-433a-841a-aeff0862cdc1",
      "name": "Eval Parser"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "4623b96f-0942-45f2-8a09-8d50d66cf558",
              "leftValue": "={{ $json.output.pass }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        2624,
        1424
      ],
      "id": "3b1ba347-9b22-4994-bede-3c04ede336a9",
      "name": "Validation Check"
    },
    {
      "parameters": {
        "jsCode": "const merge = $('Merge Config').first().json;\nconst resume = $('Resume Data Extractor').first();\n\nreturn [{\n  json: {\n    resumeData: JSON.stringify(resume.json.output ?? resume.json),\n    jobDescription: merge.jobDescription,\n    priorityWeights: merge.priorityWeights,\n    roleName: merge.roleName,\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2800,
        1424
      ],
      "id": "bee4d2a8-40f5-434f-91af-cdf5a158b9ca",
      "name": "Prepare Grading",
      "executeOnce": true,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Extracted Resume: {{ $json.resumeData }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=You are tasked with grading a candidate based on the extracted resume data. Evaluate accurately on a scale from 0 to 100.\n\nInputs:\nJob Description: {{ $('Merge Config').item.json.jobDescription }}\n\nPriority Parameters (importance scale 0-10):\n{{ (() => { try { const w = typeof $('Merge Config').item.json.priorityWeights === 'string' ? JSON.parse($('Merge Config').item.json.priorityWeights) : $('Merge Config').item.json.priorityWeights; return Object.entries(w).map(([k,v]) => k + ': ' + v).join('\\n'); } catch(e) { return 'TechnicalSkills: 8\\nRelevantWorkExperience: 8\\nEducationalBackground: 3\\nCertifications: 1\\nLocationOrWorkAuth: 1'; } })() }}\n\nScoring Methodology:\n1. For each priority parameter, evaluate candidate 0-10\n2. Multiply raw score by priority weight\n3. Sum weighted scores, normalize to 0-100\n\nCalibration:\n* 90-100: Exceptional, exceeds all requirements\n* 75-89: Strong, meets essential + several nice-to-haves\n* 60-74: Qualified, meets most essential requirements\n* 40-59: Potential, missing several key requirements\n* Below 40: Not recommended\n\nAlso provide:\n- must_match_pct: percentage of must-have requirements met\n- nice_match_pct: percentage of nice-to-have requirements met\n- strengths: array of candidate strengths\n- gaps: array of gaps/weaknesses\n- one_line_reason: single sentence summary\n\nIf the candidate's resume doesn't contain the rquired information at all/ missing crucial information to accurately assess their fit, please fill in 0.\n\nOutput JSON:\n{\n  \"score\": 0,\n  \"must_match_pct\": 0,\n  \"nice_match_pct\": 0,\n  \"strengths\": [\"...\"],\n  \"gaps\": [\"...\"],\n  \"one_line_reason\": \"...\"\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        3040,
        1280
      ],
      "id": "28f17498-282a-4784-81fb-9b2b752d344a",
      "name": "OpenAI Resume Grader",
      "retryOnFail": false,
      "maxTries": 5,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Extracted Resume: {{ $json.resumeData }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=You are tasked with grading a candidate based on the extracted resume data. Evaluate accurately on a scale from 0 to 100.\n\nInputs:\nJob Description: {{ $('Merge Config').item.json.jobDescription }}\n\nPriority Parameters (importance scale 0-10):\n{{ (() => { try { const w = typeof $('Merge Config').item.json.priorityWeights === 'string' ? JSON.parse($('Merge Config').item.json.priorityWeights) : $('Merge Config').item.json.priorityWeights; return Object.entries(w).map(([k,v]) => k + ': ' + v).join('\\n'); } catch(e) { return 'TechnicalSkills: 8\\nRelevantWorkExperience: 8\\nEducationalBackground: 3\\nCertifications: 1\\nLocationOrWorkAuth: 1'; } })() }}\n\nScoring Methodology:\n1. For each priority parameter, evaluate candidate 0-10\n2. Multiply raw score by priority weight\n3. Sum weighted scores, normalize to 0-100\n\nCalibration:\n* 90-100: Exceptional, exceeds all requirements\n* 75-89: Strong, meets essential + several nice-to-haves\n* 60-74: Qualified, meets most essential requirements\n* 40-59: Potential, missing several key requirements\n* Below 40: Not recommended\n\nIf the candidate's resume doesn't contain the rquired information at all/ missing crucial information to accurately assess their fit, please fill in 0.\n\nAlso provide:\n- must_match_pct: percentage of must-have requirements met\n- nice_match_pct: percentage of nice-to-have requirements met\n- strengths: array of candidate strengths\n- gaps: array of gaps/weaknesses\n- one_line_reason: single sentence summary\n\nOutput JSON:\n{\n  \"score\": 0,\n  \"must_match_pct\": 0,\n  \"nice_match_pct\": 0,\n  \"strengths\": [\"...\"],\n  \"gaps\": [\"...\"],\n  \"one_line_reason\": \"...\"\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        3040,
        1568
      ],
      "id": "ec3d52a4-b9b8-4935-8070-165e034886a2",
      "name": "Anthropic Resume Grader",
      "retryOnFail": false,
      "maxTries": 3,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Extracted Resume: {{ $json.resumeData }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=You are tasked with grading a candidate based on the extracted resume data. Evaluate accurately on a scale from 0 to 100.\n\nInputs:\nJob Description: {{ $('Merge Config').item.json.jobDescription }}\n\nPriority Parameters (importance scale 0-10):\n{{ (() => { try { const w = typeof $('Merge Config').item.json.priorityWeights === 'string' ? JSON.parse($('Merge Config').item.json.priorityWeights) : $('Merge Config').item.json.priorityWeights; return Object.entries(w).map(([k,v]) => k + ': ' + v).join('\\n'); } catch(e) { return 'TechnicalSkills: 8\\nRelevantWorkExperience: 8\\nEducationalBackground: 3\\nCertifications: 1\\nLocationOrWorkAuth: 1'; } })() }}\n\nScoring Methodology:\n1. For each priority parameter, evaluate candidate 0-10\n2. Multiply raw score by priority weight\n3. Sum weighted scores, normalize to 0-100\n\nCalibration:\n* 90-100: Exceptional, exceeds all requirements\n* 75-89: Strong, meets essential + several nice-to-haves\n* 60-74: Qualified, meets most essential requirements\n* 40-59: Potential, missing several key requirements\n* Below 40: Not recommended\n\nIf the candidate's resume doesn't contain the rquired information at all/ missing crucial information to accurately assess their fit, please fill in 0.\n\nAlso provide:\n- must_match_pct: percentage of must-have requirements met\n- nice_match_pct: percentage of nice-to-have requirements met\n- strengths: array of candidate strengths\n- gaps: array of gaps/weaknesses\n- one_line_reason: single sentence summary\n\nOutput JSON:\n{\n  \"score\": 0,\n  \"must_match_pct\": 0,\n  \"nice_match_pct\": 0,\n  \"strengths\": [\"...\"],\n  \"gaps\": [\"...\"],\n  \"one_line_reason\": \"...\"\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        3040,
        1840
      ],
      "id": "68e8b38c-d803-4553-b498-cafe8eecf607",
      "name": "Gemini Resume Grader",
      "retryOnFail": false,
      "maxTries": 5,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "model": "openai/gpt-5-mini",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        3136,
        1120
      ],
      "id": "20b2fef7-1a3d-4f60-bb15-82ef3ddd807e",
      "name": "LLM GPT",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "model": "anthropic/claude-3.5-sonnet",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        3040,
        1456
      ],
      "id": "bf1325ae-2850-4282-8a6e-c568fbcc5dd9",
      "name": "LLM Claude",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        3040,
        1680
      ],
      "id": "ed9e2f61-f3ff-4740-bf73-d2901084de39",
      "name": "LLM Gemini",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"score\": {{ Math.round($json.output.map(item => item.score).reduce((a, b) => a + b, 0) / $json.output.length) }},\n  \"must_match_pct\": {{ Math.round($json.output.map(item => item.must_match_pct).reduce((a, b) => a + b, 0) / $json.output.length) }},\n  \"nice_match_pct\": {{ Math.round($json.output.map(item => item.nice_match_pct).reduce((a, b) => a + b, 0) / $json.output.length) }},\n  \"strengths\": {{ JSON.stringify([...new Set($json.output.flatMap(item => item.strengths))]) }},\n  \"gaps\": {{ JSON.stringify([...new Set($json.output.flatMap(item => item.gaps))]) }},\n  \"one_line_reason\": {{ JSON.stringify($json.output.map(item => item.one_line_reason).join(' | ')) }},\n  \"resumeData\": {{ JSON.stringify($('Resume Data Extractor').item.json.output) }}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3840,
        1488
      ],
      "id": "9cec6bee-d01f-4691-a4b4-5718194561d0",
      "name": "Summary",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\nconst result = [];\n\nfor (let i = 0; i < items.length; i++) {\n  const item = items[i];\n  const binary = item.binary;\n  if (!binary) continue;\n\n  // Try to get email metadata if available\n  const json = item.json || {};\n  const senderEmail = json.from?.value?.[0]?.address || json.senderEmail || json.headers?.['from'] || '';\n  const senderName = json.from?.value?.[0]?.name || json.senderName || '';\n  const emailSubject = json.subject || json.emailSubject || '';\n\n  for (const key of Object.keys(binary)) {\n    const binaryData = binary[key];\n    result.push({\n      json: {\n        fileName: binaryData.fileName,\n        mimeType: binaryData.mimeType,\n        fileSize: binaryData.fileSize,\n        fileExtension: binaryData.fileExtension,\n        fieldName: key,\n        itemIndex: i,\n        senderEmail,\n        senderName,\n        emailSubject\n      },\n      binary: { [key]: binaryData }\n    });\n  }\n}\n\nif (result.length === 0) {\n  throw new Error('No binary data found in the input');\n}\n\nreturn result;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        272,
        1424
      ],
      "id": "0a217ade-8006-4d0b-881c-714c45934b9b",
      "name": "Binary Extractor"
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "n8n-nodes-base.splitInBatches",
      "typeVersion": 3,
      "position": [
        464,
        1424
      ],
      "id": "b3165d4b-bbef-405c-861e-face3bebeb5c",
      "name": "Loop Over Items"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.mimeType }}",
                    "rightValue": "application/pdf",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "15fdf54a-f6ee-4225-abe1-2c8cfa14983f"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.mimeType }}",
                    "rightValue": "text/html",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "66e4c72a-28aa-437c-a40e-a8e76004fe45"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.mimeType }}",
                    "rightValue": "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "c7f8668c-a360-45ff-a415-b604670ec23b"
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        656,
        1424
      ],
      "id": "deb8360e-eb12-4f02-ad26-de78ed88503b",
      "name": "Switch"
    },
    {
      "parameters": {
        "operation": "pdf",
        "binaryPropertyName": "={{$json.fieldName}}",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        848,
        1296
      ],
      "id": "968199e5-f1bd-40a9-a8cd-dbe395706af8",
      "name": "PDF EXTRACTOR"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"data\": {{ JSON.stringify($json.text ?? $json.data) }}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1088,
        1424
      ],
      "id": "79455c07-285d-4f85-b836-27c96dca2662",
      "name": "Extracted Data"
    },
    {
      "parameters": {
        "fieldsToSummarize": {
          "values": [
            {
              "aggregation": "concatenate",
              "field": "data"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.summarize",
      "typeVersion": 1.1,
      "position": [
        1232,
        1424
      ],
      "id": "a27c8c11-1640-4b23-b87b-9d90a802a89a",
      "name": "Document Data"
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        1392,
        1616
      ],
      "id": "35e531d8-3134-4a7f-867f-cad95a7049c6",
      "name": "LLM Classifier",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "inputText": "={{ $json.concatenated_data }}",
        "categories": {
          "categories": [
            {
              "category": "Resume",
              "description": "Whether or not this document is a resume/CV"
            },
            {
              "category": "No Action Required",
              "description": "When the document is not a resume/CV"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.textClassifier",
      "typeVersion": 1,
      "position": [
        1392,
        1424
      ],
      "id": "2344b68c-95a0-4b53-90ef-61f8696e634e",
      "name": "Classify Attachment",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "numberInputs": 3
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3,
      "position": [
        3520,
        1472
      ],
      "id": "8d53aae0-2149-42e8-af70-fb2733c888e8",
      "name": "Voting Merge",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"score\": 75,\n  \"must_match_pct\": 80,\n  \"nice_match_pct\": 60,\n  \"strengths\": [\"Strong React experience\", \"Good communication\"],\n  \"gaps\": [\"No .NET experience\"],\n  \"one_line_reason\": \"Strong frontend developer but lacks required backend skills\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        3312,
        1600
      ],
      "id": "d5777d83-9390-4bb1-95d3-b63309fe6da3",
      "name": "Grade Parser"
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        4016,
        1728
      ],
      "id": "f720369c-34f5-4d73-8e73-c27c7288d3c1",
      "name": "LLM Distiller",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"summary_short\": \"Kandidat memiliki pengalaman kuat di frontend React namun kurang di .NET backend.\",\n  \"recommended_status\": \"review\",\n  \"name\": \"John Doe\",\n  \"email\": \"john@email.com\",\n  \"phone\": \"+6281234567890\"\n}",
        "autoFix": true
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        4176,
        1728
      ],
      "id": "c063d7a1-06e4-492b-865f-3194e6c7bf46",
      "name": "Distilled Output"
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": 417686518,
          "mode": "list",
          "cachedResultName": "Candidates",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc/edit#gid=417686518"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Timestamp": "={{ new Date().toISOString() }}",
            "Role": "={{ $('Merge Config').item.json.roleName }}",
            "Name": "={{ $('Resume Data Extractor').item.json.output?.personal?.name || $('Distiller Agent').item.json.output?.name || '' }}",
            "Email": "={{ $('Resume Data Extractor').item.json.output?.personal?.email || $('Distiller Agent').item.json.output?.email || '' }}",
            "Phone": "={{ \"'\" + ($('Resume Data Extractor').item.json.output?.personal?.phone || $('Distiller Agent').item.json.output?.phone || '') }}",
            "Score": "={{ $('Summary').item.json.score }}",
            "Must Match %": "={{ $('Summary').item.json.must_match_pct }}",
            "Nice Match %": "={{ $('Summary').item.json.nice_match_pct }}",
            "Strengths": "={{ JSON.stringify($('Summary').item.json.strengths) }}",
            "Gaps": "={{ JSON.stringify($('Summary').item.json.gaps) }}",
            "Summary": "={{ ($('Distiller Agent').item.json.output?.summary_short || '') + '|||' + ($('Summary').item.json.one_line_reason || '') }}",
            "Status": "={{ $('Distiller Agent').item.json.output?.recommended_status || 'review' }}",
            "Source Email": "={{ $('Parse Company Input').first().json.batchId || '' }}",
            "File Name": "={{ $('Merge Config').item.json.fileName }}",
            "Resume Data": "={{ JSON.stringify($('Summary').item.json.resumeData) }}",
            "Individual Scores": "={{ JSON.stringify($('Summary').item.json.individual_scores) }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Role",
              "displayName": "Role",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Phone",
              "displayName": "Phone",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Score",
              "displayName": "Score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Must Match %",
              "displayName": "Must Match %",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Nice Match %",
              "displayName": "Nice Match %",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Strengths",
              "displayName": "Strengths",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Gaps",
              "displayName": "Gaps",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Summary",
              "displayName": "Summary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Source Email",
              "displayName": "Source Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "File Name",
              "displayName": "File Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Resume Data",
              "displayName": "Resume Data",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Individual Scores",
              "displayName": "Individual Scores",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4304,
        1488
      ],
      "id": "086544ab-fb21-44cf-b6a2-c601a820e975",
      "name": "Append Candidates Sheet",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      },
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=<Score>{{ $json.score }}</Score>\n<Strengths>{{ JSON.stringify($json.strengths) }}</Strengths>\n<Gaps>{{ JSON.stringify($json.gaps) }}</Gaps>\n<OneLiner>{{ $json.one_line_reason }}</OneLiner>\n<ResumeData>{{ $json.resumeData }}</ResumeData>\n<Locale>{{ $('Parse Company Input').first().json.locale }}</Locale>",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=You are a candidate assessment distiller. Generate output in the language specified by <Locale>: \"en\" = English, \"id\" = Bahasa Indonesia. Default to Bahasa Indonesia if locale is missing or unrecognized.\n\nFrom the provided scoring and resume data, create:\n1. summary_short: A 2-4 sentence summary about the candidate and their fit for the role\n2. recommended_status: \"shortlist\" (score >= 75), \"review\" (score 50-74), or \"reject\" (score < 50)\n\nAlso extract from ResumeData:\n- name, email, phone\n\nOutput JSON:\n{\n  \"summary_short\": \"...\",\n  \"recommended_status\": \"shortlist|review|reject\",\n  \"name\": {{ $json.resumeData.personal.name }},\n  \"email\": {{ $('Resume Data Extractor').item.json.output.personal.email }},\n  \"phone\": {{ $('Resume Data Extractor').item.json.output.personal.phone }}\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        4000,
        1488
      ],
      "id": "c0a6106d-15d4-4808-bd7f-96215e496e46",
      "name": "Distiller Agent",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "output"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        3680,
        1488
      ],
      "id": "d4145848-8383-481f-89f4-89b648cd3fe1",
      "name": "Aggregate",
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "429f9dea-6f42-4918-9672-95ee3257a79a",
        "responseMode": "responseNode",
        "options": {
          "rawBody": false
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        64,
        1552
      ],
      "id": "ed4c45b4-530f-492c-b484-cfb5ac9b27f9",
      "name": "Webhook",
      "webhookId": "429f9dea-6f42-4918-9672-95ee3257a79a",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "text",
        "binaryPropertyName": "={{$json.fieldName}}",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        848,
        1504
      ],
      "id": "a50f34e4-d04c-4ea1-8107-28d595de15d1",
      "name": "HTML EXTRACTOR"
    },
    {
      "parameters": {
        "content": "### \ud83d\udcca Status Polling Webhook (Shared)\nEndpoint: `POST /cekcv-poll-status`\n\nFrontend bisa poll progress kapan saja:\n- `Status Poll Webhook` \u2192 terima `{ jobId }` atau `{ batchId }`\n- `Status Lookup` \u2192 determine query type\n- `Read Job Status` \u2192 baca dari Google Sheets\n- `Format Poll Response` \u2192 format response dengan status terkini\n- `Respond Poll Status` \u2192 return ke frontend\n\nWorks for both **Individual** (`jobId`) and **Company** (`batchId`) flows.",
        "height": 240,
        "color": 6,
        "width": 920
      },
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        32,
        -528
      ],
      "typeVersion": 1,
      "id": "3a5f3208-85e5-439a-9f86-40ade31e4b45",
      "name": "Sticky Note1"
    },
    {
      "parameters": {
        "jsCode": "const item = $input.first();\nconst body = item.json.body || item.json;\n\nconst jobtarget = (body.jobtarget || body.jobTarget || body.job_target || body.jobDescription || '').trim();\nconst isLinkedIn = /linkedin\\.com\\/(jobs|job|posts|pulse|feed)/i.test(jobtarget);\nconst locale = (body.locale || 'id').trim();\n\nreturn [{\n  json: {\n    jobtarget,\n    hasLinkedIn: isLinkedIn,\n    linkedinUrl: isLinkedIn ? jobtarget : '',\n    jobDescriptionText: isLinkedIn ? '' : jobtarget,\n    locale\n  },\n  binary: item.binary\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        192,
        320
      ],
      "id": "ba1947f7-c80b-438d-94ec-bab03f04b497",
      "name": "Parse Webhook Input1"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "308876b5-b973-42b3-8dc7-d3c3925a5665",
        "responseMode": "responseNode",
        "options": {
          "rawBody": false
        }
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2.1,
      "position": [
        48,
        320
      ],
      "id": "7ceeaad1-c160-4d84-b9e1-83ae344169d7",
      "name": "Webhook1",
      "webhookId": "308876b5-b973-42b3-8dc7-d3c3925a5665",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"RoleName\": {{ JSON.stringify($json.output.roleName || 'Untitled Role') }},\n  \"JobDescription\": {{ JSON.stringify($json.output.jobDescription || $('Parse Webhook Input1').item.json.jobDescriptionText || '') }},\n  \"PriorityWeights\": {{ JSON.stringify($json.output.priorityWeights || '{\"TechnicalSkills\":5,\"RelevantWorkExperience\":5,\"EducationalBackground\":5,\"Certifications\":5,\"LocationOrWorkAuth\":5}') }},\n  \"Status\": \"active\",\n  \"CreatedAt\": \"{{ new Date().toISOString() }}\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        848,
        432
      ],
      "id": "d275acea-62d9-4f29-937b-d469b26165b3",
      "name": "Normalize Text JD"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"roleName\": \"Investment Analyst\",\n  \"jobDescription\": \"We are looking for...\",\n  \"priorityWeights\": \"{\\\"TechnicalSkills\\\":7,\\\"RelevantWorkExperience\\\":9,\\\"EducationalBackground\\\":5,\\\"Certifications\\\":6,\\\"LocationOrWorkAuth\\\":3}\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        688,
        656
      ],
      "id": "a85dd09f-459f-459f-92f5-c817271c3c68",
      "name": "JD Text Output Parser"
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        544,
        656
      ],
      "id": "aa9206be-0217-470f-ad12-253bd26ac38c",
      "name": "LLM JD Text Analyzer",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Analyze this job description:\n\n{{ $json.jobDescriptionText }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "You are an expert HR/recruitment analyst. Given a job description, extract structured information.\n\nTASKS:\n1. **roleName**: Extract the exact job title. If not explicitly stated, infer from the description.\n\n2. **jobDescription**: Return the full job description text as-is (cleaned up, preserve all content).\n\n3. **priorityWeights**: Analyze the job requirements and assign importance weights (1-10):\n   - TechnicalSkills: How important are specific technical skills, tools, frameworks?\n   - RelevantWorkExperience: How important is years/type of prior experience?\n   - EducationalBackground: How important is formal education?\n   - Certifications: How important are professional certifications?\n   - LocationOrWorkAuth: How important is location or work authorization?\n\n   RULES:\n   - Many technical requirements listed \u2192 TechnicalSkills = 7-10\n   - \"5+ years required\" \u2192 RelevantWorkExperience = 7-9\n   - \"Bachelor's required, Master's preferred\" \u2192 EducationalBackground = 5-7\n   - \"degree not required\" \u2192 EducationalBackground = 1-2\n   - Specific certs mentioned (AWS, PMP, CFA) \u2192 Certifications = 5-8\n   - No certs mentioned \u2192 Certifications = 1-2\n   - Location/visa specified \u2192 LocationOrWorkAuth = 5-8\n   - Remote/no location \u2192 LocationOrWorkAuth = 1-2\n\nOutput ONLY valid JSON, no markdown, no backticks:\n{\n  \"roleName\": \"...\",\n  \"jobDescription\": \"...\",\n  \"priorityWeights\": \"{\\\"TechnicalSkills\\\":N,\\\"RelevantWorkExperience\\\":N,\\\"EducationalBackground\\\":N,\\\"Certifications\\\":N,\\\"LocationOrWorkAuth\\\":N}\"\n}\n\nNOTE: priorityWeights must be a JSON STRING (stringified), not a nested object."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        544,
        432
      ],
      "id": "5ad5f760-2c47-43b6-a6b6-667a146d13fb",
      "name": "Analyze JD from Text"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "list",
          "cachedResultName": "CV_Screener_Workbook_Template",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 601545184,
          "mode": "list",
          "cachedResultName": "JobTarget",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc/edit#gid=601545184"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2496,
        208
      ],
      "id": "d96f0eb2-dcd8-4fbf-bcd4-c93188979ade",
      "name": "Read JobTarget",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "list",
          "cachedResultName": "CV_Screener_Workbook_Template",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 601545184,
          "mode": "list",
          "cachedResultName": "JobTarget",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc/edit#gid=601545184"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "RoleName": "={{ $json.RoleName }}",
            "JobDescription": "={{ $json.JobDescription }}",
            "PriorityWeights": "={{ $json.PriorityWeights }}",
            "Status": "={{ $json.Status }}",
            "CreatedAt": "={{ $json.CreatedAt }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "RoleName",
              "displayName": "RoleName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "JobDescription",
              "displayName": "JobDescription",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "PriorityWeights",
              "displayName": "PriorityWeights",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "Status",
              "displayName": "Status",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            },
            {
              "id": "CreatedAt",
              "displayName": "CreatedAt",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1072,
        432
      ],
      "id": "72291a99-92a1-44f2-962e-b07ee298acb9",
      "name": "Write JobTarget",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "list",
          "cachedResultName": "CV_Screener_Workbook_Template",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc/edit?usp=drivesdk"
        },
        "sheetName": {
          "__rl": true,
          "value": 265008862,
          "mode": "list",
          "cachedResultName": "ImprovementLog",
          "cachedResultUrl": "https://docs.google.com/spreadsheets/d/1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc/edit#gid=265008862"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Timestamp": "={{ $json.metadata.analyzed_at }}",
            "Name": "={{ $json.candidate.name }}",
            "Email": "={{ $json.candidate.email }}",
            "Role": "={{ $json.role }}",
            "Current Score": "={{ $json.current_assessment.overall_score }}",
            "Estimated Improvement Score": "={{ $json.score_projection.estimated_improved_score }}",
            "Potential Gain": "={{ $json.score_projection.potential_gain }}",
            "Must Match %": "={{ $json.current_assessment.must_match_percentage }}",
            "Nice Match %": "={{ $json.current_assessment.nice_match_percentage }}",
            "Strengths": "={{ $json.current_assessment.strengths }}",
            "Gaps": "={{ $json.current_assessment.gaps }}",
            "Missing Keywords": "={{ $json.improvements.missing_keywords }}",
            "Top Priority Actions": "={{ $json.improvements.top_3_priority_actions }}",
            "ATS Tips": "={{ $json.improvements.ats_formatting_tips }}",
            "Score Summary": "={{ $json.score_projection.summary }}",
            "File Name": "=Resume Improved -  {{ $json.candidate.name }}",
            "Improvement Details": "={{ $json.improvements.suggestions }}",
            "Resume generated": "={{ $json.metadata.resume_generated }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Timestamp",
              "displayName": "Timestamp",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Name",
              "displayName": "Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Email",
              "displayName": "Email",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Role",
              "displayName": "Role",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Current Score",
              "displayName": "Current Score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Estimated Improvement Score",
              "displayName": "Estimated Improvement Score",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Potential Gain",
              "displayName": "Potential Gain",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Must Match %",
              "displayName": "Must Match %",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Nice Match %",
              "displayName": "Nice Match %",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Strengths",
              "displayName": "Strengths",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Gaps",
              "displayName": "Gaps",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Missing Keywords",
              "displayName": "Missing Keywords",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Top Priority Actions",
              "displayName": "Top Priority Actions",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Improvement Details",
              "displayName": "Improvement Details",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "ATS Tips",
              "displayName": "ATS Tips",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Score Summary",
              "displayName": "Score Summary",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "File Name",
              "displayName": "File Name",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            },
            {
              "id": "Resume generated",
              "displayName": "Resume generated",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6304,
        224
      ],
      "id": "d8f9b531-a9cb-496d-be41-1d3975773989",
      "name": "Log Improvements",
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const summary = $items('Summary1')[0].json;\nconst distiller = $items('Distiller Agent1')[0].json;\nconst advisorRaw = $items('Resume Improvement Advisor')[0].json;\nconst advisor = advisorRaw.output || {};\nconst mergeConfig = $items('Merge Config1')[0].json;\n\n// Both parallel paths have completed (Merge waits for all inputs)\nconst genResumeRaw = $items('Generate Improved Resume')[0].json;\n// Handle parser/LLM errors: output may be missing if the model failed\nconst improvedResumeOutput = genResumeRaw.output || {};\nconst resumeError = genResumeRaw.error ? String(genResumeRaw.error) : null;\n\n// Defensive: Parse & Rank Jobs may not have executed (Apify error, etc.)\nlet jobData = { recommended_jobs: [], total_jobs_found: 0, search_query: '', search_location: '' };\ntry {\n  jobData = $items('Parse & Rank Jobs')[0].json;\n} catch (e) {\n  // Fallback: no jobs found, continue without crashing\n}\n\nconst distillerOutput = distiller.output || {};\n\nconst response = {\n  success: true,\n\n  candidate: {\n    name: distillerOutput.name || '',\n    email: distillerOutput.email || '',\n    phone: distillerOutput.phone || '',\n  },\n  \n  role: mergeConfig.roleName || '',\n  \n  current_assessment: {\n    overall_score: summary.score || 0,\n    must_match_percentage: summary.must_match_pct || 0,\n    nice_match_percentage: summary.nice_match_pct || 0,\n    status: distillerOutput.recommended_status || '',\n    summary: distillerOutput.summary_short || '',\n    strengths: summary.strengths || [],\n    gaps: summary.gaps || [],\n  },\n  \n  score_breakdown: advisor.score_breakdown || [],\n  \n  improvements: {\n    missing_keywords: advisor.missing_keywords || [],\n    suggestions: advisor.improvement_suggestions || [],\n    ats_formatting_tips: advisor.ats_formatting_tips || [],\n    top_3_priority_actions: advisor.top_3_priority_actions || [],\n  },\n  \n  score_projection: {\n    current_score: summary.score || 0,\n    estimated_improved_score: advisor.estimated_improved_score || 0,\n    potential_gain: (advisor.estimated_improved_score || 0) - (summary.score || 0),\n    summary: advisor.score_potential_summary || '',\n  },\n  \n  improved_resume: {\n    text: improvedResumeOutput.improved_resume_text || '',\n    html: improvedResumeOutput.improved_resume_html || '',\n    changes_made: improvedResumeOutput.changes_made || [],\n    keywords_added: improvedResumeOutput.keywords_added || [],\n    error: resumeError,\n  },\n  \n  recommended_jobs: {\n    jobs: jobData.recommended_jobs || [],\n    total_found: jobData.total_jobs_found || 0,\n    search_query: jobData.search_query || '',\n    search_location: jobData.search_location || '',\n  },\n  \n  metadata: {\n    analyzed_at: new Date().toISOString(),\n    file_name: mergeConfig.fileName || '',\n    resume_generated: !resumeError,\n  }\n};\n\nreturn [{ json: response }];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5680,
        224
      ],
      "id": "80cc2865-d631-4927-941a-4b44255f69b6",
      "name": "Prepare Webhook Response"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"score_breakdown\": [\n    {\n      \"category\": \"TechnicalSkills\",\n      \"current_score\": 6,\n      \"max_score\": 10,\n      \"weight\": 8,\n      \"weighted_current\": 48,\n      \"weighted_max\": 80,\n      \"verdict\": \"adequate\"\n    }\n  ],\n  \"missing_keywords\": [\"React\", \"TypeScript\"],\n  \"improvement_suggestions\": [\n    {\n      \"category\": \"TechnicalSkills\",\n      \"priority\": \"high\",\n      \"title\": \"Add React & TypeScript Skills\",\n      \"gap\": \"No mention of React\",\n      \"suggestion\": \"Add React to skills section\",\n      \"estimated_point_gain\": 8\n    }\n  ],\n  \"ats_formatting_tips\": [\"Use standard headers\"],\n  \"top_3_priority_actions\": [\"Add keywords\", \"Quantify achievements\", \"Add certifications\"],\n  \"estimated_improved_score\": 85,\n  \"score_potential_summary\": \"Your current score is 62. You could reach 85.\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        4496,
        448
      ],
      "id": "b300a07a-91f0-45ea-9a15-e781895ab153",
      "name": "Advisor Output Parser"
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.6",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        4352,
        448
      ],
      "id": "66e72d0f-18b5-46c3-b7c1-35d6303684fd",
      "name": "LLM Advisor",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "==<CurrentScore>{{ $items('Summary1')[0].json.score }}</CurrentScore>\n<MustMatchPct>{{ $items('Summary1')[0].json.must_match_pct }}</MustMatchPct>\n<NiceMatchPct>{{ $items('Summary1')[0].json.nice_match_pct }}</NiceMatchPct>\n<Strengths>{{ JSON.stringify($items('Summary1')[0].json.strengths) }}</Strengths>\n<Gaps>{{ JSON.stringify($items('Summary1')[0].json.gaps) }}</Gaps>\n<OneLiner>{{ $items('Summary1')[0].json.one_line_reason }}</OneLiner>\n<ResumeData>{{ JSON.stringify($items('Summary1')[0].json.resumeData) }}</ResumeData>",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "You are an expert ATS (Applicant Tracking System) resume optimization consultant. Your job is to analyze the gap between a candidate's resume and the job requirements, then provide actionable, specific improvements.\n\nGiven the candidate's current score, gaps, strengths, resume data, and the job description, produce a detailed improvement report.\n\nANALYSIS RULES:\n1. Compare resume keywords vs job description keywords - identify EXACT missing keywords\n2. For each gap, provide a SPECIFIC, actionable suggestion (not generic advice)\n3. Estimate how many points each improvement could add\n4. Prioritize by impact (highest weight categories first)\n5. Be realistic - don't suggest fabricating experience\n\nOUTPUT JSON (strict):\n{\n  \"score_breakdown\": [\n    {\n      \"category\": \"TechnicalSkills\",\n      \"current_score\": 6,\n      \"max_score\": 10,\n      \"weight\": 8,\n      \"weighted_current\": 48,\n      \"weighted_max\": 80,\n      \"verdict\": \"strong|adequate|weak|missing\"\n    }\n  ],\n  \"missing_keywords\": [\"keyword1\", \"keyword2\"],\n  \"improvement_suggestions\": [\n    {\n      \"category\": \"TechnicalSkills\",\n      \"priority\": \"high\",\n      \"gap\": \"No mention of React or TypeScript\",\n      \"suggestion\": \"Add a Technical Skills section listing: React, TypeScript, Next.js. If you have project experience with these, describe it.\",\n      \"estimated_point_gain\": 8\n    }\n  ],\n  \"ats_formatting_tips\": [\n    \"Use standard section headers: Experience, Education, Skills, Certifications\",\n    \"Avoid tables, columns, or graphics that ATS cannot parse\"\n  ],\n  \"top_3_priority_actions\": [\n    \"Add missing technical keywords: React, TypeScript, AWS\",\n    \"Quantify achievements with metrics\",\n    \"Add relevant certifications or online courses\"\n  ],\n  \"estimated_improved_score\": 85,\n  \"score_potential_summary\": \"Your current score is 62/100. By implementing the suggested changes, you could potentially reach 82-88/100.\"\n}\n\nIMPORTANT:\n- estimated_improved_score must be realistic (never exceed 95)\n- Each suggestion must reference specific content from the job description\n- missing_keywords must be actual terms from the job description not found in resume\n- score_breakdown categories must match the priority weight categories provided"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        4352,
        224
      ],
      "id": "2db51cf6-d61f-4c7d-a025-910edd490718",
      "name": "Resume Improvement Advisor",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// Re-attach the original webhook binary data so Binary Extractor can process the file\n// Use Generate Job ID which explicitly forwards binary data,\n// avoiding broken item pairing from the AI agent node\nconst sourceItem = $('Generate Job ID').first();\n\nif (!sourceItem.binary || Object.keys(sourceItem.binary).length === 0) {\n  throw new Error('No file was uploaded via the webhook. Please upload a resume file.');\n}\n\n// Merge: keep current JSON context + original binary\nreturn [{\n  json: {\n    ...sourceItem.json,\n    roleConfigWritten: true\n  },\n  binary: sourceItem.binary\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1216,
        432
      ],
      "id": "c25b0a76-d533-422b-93f8-1a2504134293",
      "name": "Restore File Data"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"RoleName\": {{ JSON.stringify($json.output.roleName || $('Parse Webhook Input1').item.json.roleName || 'Untitled Role') }},\n  \"JobDescription\": {{ JSON.stringify($json.output.jobDescription || '') }},\n  \"PriorityWeights\": {{ JSON.stringify($json.output.priorityWeights || '{\"TechnicalSkills\":8,\"RelevantWorkExperience\":8,\"EducationalBackground\":3,\"Certifications\":1,\"LocationOrWorkAuth\":1}') }},\n  \"Status\": \"active\",\n  \"CreatedAt\": \"{{ new Date().toISOString() }}\"\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        928,
        48
      ],
      "id": "5179b6b8-b88f-4302-b23d-725fe8a63629",
      "name": "Set JD from LinkedIn"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"roleName\": \"Senior Software Engineer\",\n  \"jobDescription\": \"We are looking for...\",\n  \"priorityWeights\": \"{\\\"TechnicalSkills\\\":8,\\\"RelevantWorkExperience\\\":8,\\\"EducationalBackground\\\":3,\\\"Certifications\\\":1,\\\"LocationOrWorkAuth\\\":1}\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        800,
        240
      ],
      "id": "2e898757-5cd2-4bae-9e29-83676279de2b",
      "name": "JD Output Parser"
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        656,
        240
      ],
      "id": "c0f2c6d9-a086-4fe5-b234-706279b0ab24",
      "name": "LLM JD Extractor",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Here is the content of a LinkedIn job posting page:\n\n{{ $json.data || $json.body || $json }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "You are a job description extraction specialist.\n\nFrom the provided LinkedIn job posting content, extract:\n\n1. **roleName**: The exact job title (e.g., \"Senior Frontend Engineer\", \"Data Analyst\")\n2. **jobDescription**: The COMPLETE job description including:\n   - Role overview/summary\n   - Responsibilities\n   - Requirements / Qualifications\n   - Nice-to-haves (if any)\n   - Benefits (if any)\n   Format as clean readable text, NOT HTML.\n3. **priorityWeights**: Based on the job requirements, assign weights (1-10) for:\n   - TechnicalSkills\n   - RelevantWorkExperience\n   - EducationalBackground\n   - Certifications\n   - LocationOrWorkAuth\n   Output as JSON string.\n\nOutput ONLY valid JSON. No markdown, no backticks."
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        656,
        48
      ],
      "id": "e204da53-6cb5-42c0-a339-68610b814259",
      "name": "Extract JD from Page"
    },
    {
      "parameters": {
        "url": "=https://r.jina.ai/{{ $json.linkedinUrl }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "text/plain"
            },
            {
              "name": "X-Return-Format",
              "value": "text"
            }
          ]
        },
        "options": {
          "timeout": 30000
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        512,
        48
      ],
      "id": "1aecddf4-1023-4b22-9e35-c18c3e537ce2",
      "name": "Fetch LinkedIn Page"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "linkedin-check-condition",
              "leftValue": "={{ $json.hasLinkedIn }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        352,
        320
      ],
      "id": "73c95c24-f46c-41fa-a03e-35735c3fca1c",
      "name": "Is LinkedIn URL?"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=<OriginalResume>{{ JSON.stringify($items('Summary1')[0].json.resumeData) }}</OriginalResume>\n<ImprovementSuggestions>{{ JSON.stringify($json.output.improvement_suggestions) }}</ImprovementSuggestions>\n<MissingKeywords>{{ JSON.stringify($json.output.missing_keywords) }}</MissingKeywords>\n<ATSTips>{{ JSON.stringify($json.output.ats_formatting_tips) }}</ATSTips>\n<TopActions>{{ JSON.stringify($json.output.top_3_priority_actions) }}</TopActions>\n<JobDescription>{{ $items('Merge Config1')[0].json.jobDescription }}</JobDescription>\n<RoleName>{{ $items('Merge Config1')[0].json.roleName }}</RoleName>",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "You are a professional resume writer and ATS optimization expert.\n\nGiven the candidate's original resume and specific improvement suggestions, rewrite the resume to score higher on ATS systems.\n\nRULES:\n1. PRESERVE all factual information - do NOT fabricate experience, skills, or qualifications\n2. INCORPORATE missing keywords naturally into existing descriptions where truthful\n3. RESTRUCTURE sections for optimal ATS parsing (use standard headers)\n4. QUANTIFY achievements where the original text implies metrics\n5. IMPROVE bullet points to be action-verb + result oriented\n6. ADD a Professional Summary section optimized for the target role\n7. REORDER sections by relevance to the job description\n8. Keep formatting ATS-friendly: no tables, columns, or graphics\n\nOUTPUT JSON:\n{\n  \"improved_resume_text\": \"The full improved resume as clean formatted text with clear section headers\",\n  \"improved_resume_html\": \"<html>The full improved resume as professional HTML. Use clean styling: professional font, proper spacing, clear headers. Include inline CSS.</html>\",\n  \"changes_made\": [\n    \"Added missing keywords to relevant sections\",\n    \"Restructured Professional Summary to target the specific role\",\n    \"Quantified project outcomes with estimated metrics\"\n  ],\n  \"keywords_added\": [\"keyword1\", \"keyword2\"],\n  \"sections_reordered\": true\n}\n\nIMPORTANT:\n- The HTML must be a complete, self-contained document with inline CSS\n- Use professional styling (clean fonts, proper margins, readable layout)\n- Do NOT add skills or experience the candidate doesn't have\n- DO rephrase existing experience to highlight relevance to the target role"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        4640,
        224
      ],
      "id": "b43c3590-2f00-40d5-875f-51d2d8a5b76b",
      "name": "Generate Improved Resume",
      "retryOnFail": true,
      "maxTries": 3,
      "waitBetweenTries": 5000,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-pro",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        4640,
        448
      ],
      "id": "ffae5568-a26b-466a-ac1a-cddd4ab5a08f",
      "name": "LLM Resume Writer",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"improved_resume_text\": \"JESSELYN HASNAH\\nSydney, Australia...\",\n  \"improved_resume_html\": \"<html><head><style>body{font-family:Arial}</style></head><body>...</body></html>\",\n  \"changes_made\": [\"Added GHG Protocol keywords\", \"Restructured summary\"],\n  \"keywords_added\": [\"GHG Protocol\", \"TCFD\"],\n  \"sections_reordered\": true\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        4784,
        448
      ],
      "id": "d5a9c82e-e206-49ff-9ac3-7638e525ace6",
      "name": "Resume Writer Parser"
    },
    {
      "parameters": {
        "jsCode": "// Parse Apify results and rank by relevance\nconst jobs = $input.all().map(item => item.json);\nconst jobParams = $items('Edit Fields')[0].json;\nconst summary = $items('Summary1')[0].json;\n\nconst candidateStrengths = (summary.strengths || []).join(' ').toLowerCase();\n\nconst formattedJobs = jobs.map((job, idx) => {\n  const title = job.title || '';\n  const company = job.company || '';\n  const location = job.location || '';\n  const description = job.description || '';\n  const url = job.link || job.url || '';\n  const postedAt = job.postedDate || '';\n  const salary = job.salary || '';\n  const skills = job.skills || [];\n  const jobId = job.jobId || '';\n\n  // Relevance scoring\n  const descLower = (description + ' ' + title + ' ' + skills.join(' ')).toLowerCase();\n  let relevance = 0;\n  const words = candidateStrengths.split(/\\s+/).filter(w => w.length > 4);\n  for (const word of words) {\n    if (descLower.includes(word)) relevance++;\n  }\n\n  return {\n    rank: idx + 1,\n    title,\n    company,\n    location,\n    url,\n    posted_at: postedAt,\n    salary,\n    skills: skills.slice(0, 10),\n    job_id: jobId,\n    description_preview: description.substring(0, 300) + (description.length > 300 ? '...' : ''),\n    relevance_score: relevance,\n  };\n}).sort((a, b) => b.relevance_score - a.relevance_score)\n  .map((job, idx) => ({ ...job, rank: idx + 1 }));\n\nreturn [{\n  json: {\n    recommended_jobs: formattedJobs.slice(0, 20),\n    total_jobs_found: jobs.length,\n    search_query: (jobParams.Job_to_scrapes || [])[0] || '',\n    search_location: jobParams.location || '',\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5520,
        224
      ],
      "id": "2511e80a-2625-4bfb-b191-eb3ce0922bb6",
      "name": "Parse & Rank Jobs"
    },
    {
      "parameters": {
        "operation": "Run actor and get dataset",
        "actorId": {
          "__rl": true,
          "value": "3fAlg6T4zBeu2Kgik",
          "mode": "list",
          "cachedResultName": "\ud83d\udccc LinkedIn Jobs Scraper (Fast & reliable listings) (aliand.api/LinkedIn-Jobs-Scraper-v2)",
          "cachedResultUrl": "https://console.apify.com/actors/3fAlg6T4zBeu2Kgik/input"
        },
        "customBody": "={\n  \"apifyProxyGroups\": \"RESIDENTIAL\",\n\"keywords\": {{ JSON.stringify($json.keywords) }},\n  \"location\": \"{{ $json.location }}\",\n  \"maxItems\": \"{{ $json.maxItems }}\",\n  \"postingDateRange\": \"r604800\"\n}\n",
        "timeout": 300
      },
      "type": "@apify/n8n-nodes-apify.apify",
      "typeVersion": 1,
      "position": [
        5344,
        224
      ],
      "id": "1d155401-b7fa-4619-984d-36b96a0e20e1",
      "name": "Run an Actor and get dataset",
      "credentials": {
        "apifyApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Apify"
        }
      },
      "disabled": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Analyze this candidate's resume and the job context to determine the best job search parameters.\n\n<ResumeText>{{ JSON.stringify($items('Summary1')[0].json.resumeData) }}</ResumeText>\n<RoleName>{{ $items('Merge Config1')[0].json.roleName }}</RoleName>\n<JobDescription>{{ $items('Merge Config1')[0].json.jobDescription }}</JobDescription>\n<Strengths>{{ JSON.stringify($items('Summary1')[0].json.strengths) }}</Strengths>",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "You are a job search optimization expert. Given a candidate's resume, their target role, and their strengths, determine the optimal LinkedIn job search parameters.\n\nTASKS:\n1. **Job_to_scrapes**: Generate 5-8 specific job search keywords that the candidate would score highest on. Include:\n   - The exact role name and variations\n   - Related roles the candidate is qualified for\n   - Industry-specific keywords\n   - Mix of specific and broader terms\n   \n2. **location**: Extract the candidate's CITY only (not full address, not their name). Look for where they currently live or are based. Return just the city name (e.g., \"Sydney\", \"Melbourne\", \"Jakarta\", \"London\").\n\n3. **limit**: Always return 20.\n\nOUTPUT ONLY valid JSON, no markdown, no backticks:\n{\n  \"Job_to_scrapes\": [\"Sustainability Consultant\", \"ESG Analyst\", \"Climate Risk\", \"Carbon Accounting\", \"Graduate Sustainability\"],\n  \"location\": \"Sydney\",\n  \"limit\": 20\n}\n\nRULES:\n- Job_to_scrapes must be an array of strings, each a separate search keyword\n- location must be a single city name, nothing else\n- limit must be 20\n- Keywords should reflect roles where the candidate's existing skills match well\n- Include both the target role and adjacent roles they'd qualify for"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        4912,
        224
      ],
      "id": "38831d53-6586-40d3-bd39-5dcc81bd0619",
      "name": "Extract Job Search Params"
    },
    {
      "parameters": {
        "model": "anthropic/claude-sonnet-4.6",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        4912,
        448
      ],
      "id": "8dfa2992-1c0c-4d09-a03f-a4ccda638017",
      "name": "LLM Job Search",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"Job_to_scrapes\": [\"Sustainability Consultant\", \"ESG Analyst\", \"Climate Risk Advisor\"],\n  \"location\": \"Sydney\",\n  \"limit\": 20\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        5056,
        448
      ],
      "id": "2eeca985-99cf-46b2-a127-989423244c06",
      "name": "Job Search Parser"
    },
    {
      "parameters": {
        "jsCode": "// Build a polished professional ATS-friendly resume HTML\nconst response = $input.first().json;\nconst resumeText = response.improved_resume?.text || '';\nconst candidate = response.candidate || {};\nconst name = candidate.name || 'Candidate';\nconst email = candidate.email || '';\nconst phone = candidate.phone || '';\nconst role = response.role || '';\nconst safeName = name.replace(/[^a-zA-Z0-9]/g, '_');\nconst fileName = 'Resume_Improved_' + safeName + '.html';\n\n// Parse resume text into sections\nconst lines = resumeText.split('\\n').filter(l => l.trim());\n\n// Detect section headers (ALL CAPS lines or known headers)\nconst sectionHeaders = [\n  'PROFESSIONAL SUMMARY', 'SUMMARY', 'PROFILE', 'OBJECTIVE',\n  'EDUCATION', 'ACADEMIC BACKGROUND',\n  'EXPERIENCE', 'WORK EXPERIENCE', 'PROFESSIONAL EXPERIENCE', 'ACADEMIC & PROFESSIONAL EXPERIENCE',\n  'SKILLS', 'TECHNICAL SKILLS', 'CORE COMPETENCIES', 'KEY SKILLS',\n  'CERTIFICATIONS', 'CERTIFICATES', 'LICENSES',\n  'ACHIEVEMENTS', 'SELECTED ACHIEVEMENTS', 'AWARDS', 'HONORS',\n  'PROJECTS', 'KEY PROJECTS',\n  'LANGUAGES', 'ADDITIONAL INFORMATION',\n  'TEACHING, LEADERSHIP & SOCIAL IMPACT', 'LEADERSHIP', 'VOLUNTEER',\n  'PUBLICATIONS', 'INTERESTS', 'REFERENCES'\n];\n\nfunction isHeader(line) {\n  const clean = line.replace(/[^a-zA-Z\\s&,]/g, '').trim().toUpperCase();\n  return sectionHeaders.some(h => clean.includes(h) || h.includes(clean)) && clean.length > 3;\n}\n\n// Build sections\nlet sections = [];\nlet currentSection = { header: '', items: [] };\n\nfor (const line of lines) {\n  if (isHeader(line)) {\n    if (currentSection.header || currentSection.items.length) {\n      sections.push({ ...currentSection });\n    }\n    currentSection = { header: line.trim(), items: [] };\n  } else {\n    currentSection.items.push(line.trim());\n  }\n}\nif (currentSection.header || currentSection.items.length) {\n  sections.push(currentSection);\n}\n\n// Build section HTML\nlet sectionsHtml = '';\nfor (const sec of sections) {\n  if (sec.header) {\n    sectionsHtml += `<div class=\"section\">\n      <h2>${sec.header}</h2>\n      <div class=\"section-content\">`;\n    for (const item of sec.items) {\n      // Detect sub-headers (company names, dates, job titles)\n      if (item.match(/^[A-Z].*\\s*[\u2014\u2013-]\\s*.*(20\\d{2}|Present|Current)/)) {\n        sectionsHtml += `<div class=\"job-header\">${item}</div>`;\n      } else if (item.match(/^\\d+\\.\\s/)) {\n        sectionsHtml += `<div class=\"list-item\">${item.replace(/^\\d+\\.\\s*/, '')}</div>`;\n      } else if (item.startsWith('\u2022') || item.startsWith('-') || item.startsWith('\u2013')) {\n        sectionsHtml += `<div class=\"bullet\">${item.replace(/^[\u2022\\-\u2013]\\s*/, '')}</div>`;\n      } else {\n        sectionsHtml += `<p>${item}</p>`;\n      }\n    }\n    sectionsHtml += `</div></div>`;\n  } else {\n    // Pre-header content (intro text)\n    for (const item of sec.items) {\n      if (item !== name && item !== email && item !== phone) {\n        sectionsHtml += `<p>${item}</p>`;\n      }\n    }\n  }\n}\n\nconst html = `<!DOCTYPE html>\n<html lang=\"en\">\n<head>\n<meta charset=\"UTF-8\">\n<meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n<title>${name} - Resume</title>\n<style>\n  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap');\n  \n  * { margin: 0; padding: 0; box-sizing: border-box; }\n  \n  @page {\n    size: A4;\n    margin: 0;\n  }\n  \n  body {\n    font-family: 'Inter', 'Calibri', 'Helvetica Neue', Arial, sans-serif;\n    font-size: 10.5pt;\n    line-height: 1.5;\n    color: #1a1a1a;\n    background: #ffffff;\n    -webkit-font-smoothing: antialiased;\n  }\n  \n  .page {\n    max-width: 800px;\n    margin: 0 auto;\n    padding: 40px 50px;\n  }\n  \n  /* Header */\n  .header {\n    text-align: center;\n    padding-bottom: 16px;\n    margin-bottom: 20px;\n    border-bottom: 2px solid #2563EB;\n  }\n  \n  .header h1 {\n    font-size: 22pt;\n    font-weight: 700;\n    color: #111827;\n    letter-spacing: 0.5px;\n    margin-bottom: 4px;\n  }\n  \n  .header .role-target {\n    font-size: 11pt;\n    color: #2563EB;\n    font-weight: 500;\n    margin-bottom: 8px;\n  }\n  \n  .header .contact {\n    font-size: 9.5pt;\n    color: #4B5563;\n  }\n  \n  .header .contact span {\n    margin: 0 8px;\n  }\n  \n  .header .contact .sep {\n    color: #D1D5DB;\n  }\n  \n  /* Sections */\n  .section {\n    margin-bottom: 18px;\n  }\n  \n  .section h2 {\n    font-size: 11pt;\n    font-weight: 700;\n    color: #1E40AF;\n    text-transform: uppercase;\n    letter-spacing: 1.2px;\n    padding-bottom: 4px;\n    border-bottom: 1px solid #DBEAFE;\n    margin-bottom: 10px;\n  }\n  \n  .section-content p {\n    margin-bottom: 6px;\n    text-align: justify;\n  }\n  \n  .job-header {\n    font-weight: 600;\n    color: #111827;\n    margin-top: 10px;\n    margin-bottom: 4px;\n    font-size: 10.5pt;\n  }\n  \n  .bullet {\n    padding-left: 18px;\n    position: relative;\n    margin-bottom: 4px;\n  }\n  \n  .bullet::before {\n    content: \"\u25b8\";\n    position: absolute;\n    left: 4px;\n    color: #2563EB;\n    font-size: 9pt;\n  }\n  \n  .list-item {\n    padding-left: 18px;\n    position: relative;\n    margin-bottom: 4px;\n  }\n  \n  .list-item::before {\n    content: \"\u25b8\";\n    position: absolute;\n    left: 4px;\n    color: #2563EB;\n    font-size: 9pt;\n  }\n  \n  /* Skills grid */\n  .skills-grid {\n    display: flex;\n    flex-wrap: wrap;\n    gap: 6px;\n  }\n  \n  .skill-tag {\n    background: #EFF6FF;\n    color: #1E40AF;\n    padding: 3px 10px;\n    border-radius: 4px;\n    font-size: 9.5pt;\n    font-weight: 500;\n  }\n  \n  /* Print styles */\n  @media print {\n    body { background: white; }\n    .page { padding: 30px 40px; max-width: none; }\n    .section { break-inside: avoid; }\n  }\n</style>\n</head>\n<body>\n<div class=\"page\">\n  <div class=\"header\">\n    <h1>${name}</h1>\n    ${role ? '<div class=\"role-target\">' + role + '</div>' : ''}\n    <div class=\"contact\">\n      ${email ? '<span>' + email + '</span>' : ''}\n      ${email && phone ? '<span class=\"sep\">|</span>' : ''}\n      ${phone ? '<span>' + phone + '</span>' : ''}\n    </div>\n  </div>\n  ${sectionsHtml}\n</div>\n</body>\n</html>`;\n\nconst binaryData = await this.helpers.prepareBinaryData(\n  Buffer.from(html, 'utf-8'),\n  fileName,\n  'text/html'\n);\n\nreturn [{\n  json: {\n    ...response,\n    resumeFileName: fileName,\n    improved_resume: {\n      ...response.improved_resume,\n      html: html,\n    }\n  },\n  binary: {\n    resume: binaryData\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5824,
        224
      ],
      "id": "ac841220-8bd5-44cd-9b84-a10bd6f2e37e",
      "name": "Create Resume File"
    },
    {
      "parameters": {
        "operation": "text",
        "binaryPropertyName": "={{$json.fieldName}}",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        1728,
        512
      ],
      "id": "1c58fbc7-6f6f-454a-af83-2e2a6e97da30",
      "name": "HTML EXTRACTOR1"
    },
    {
      "parameters": {
        "fieldsToAggregate": {
          "fieldToAggregate": [
            {
              "fieldToAggregate": "output"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        3696,
        496
      ],
      "id": "621b2e35-e561-4741-b5e1-07b559518208",
      "name": "Aggregate1"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=<Score>{{ $json.score }}</Score>\n<Strengths>{{ JSON.stringify($json.strengths) }}</Strengths>\n<Gaps>{{ JSON.stringify($json.gaps) }}</Gaps>\n<OneLiner>{{ $json.one_line_reason }}</OneLiner>\n<ResumeData>{{ $json.resumeData }}</ResumeData>\n<Locale>{{ $('Parse Webhook Input1').first().json.locale }}</Locale>",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "You are a candidate assessment distiller. Generate output in the language specified by <Locale>: \"en\" = English, \"id\" = Bahasa Indonesia. Default to Bahasa Indonesia if locale is missing or unrecognized.\n\nFrom the provided scoring and resume data, create:\n1. summary_short: A 2-4 sentence summary about the candidate and their fit for the role\n2. recommended_status: \"shortlist\" (score >= 75), \"review\" (score 50-74), or \"reject\" (score < 50)\n\nAlso extract from the ResumeData provided in the user message:\n- name (the candidate's full name)\n- email (the candidate's email address)\n- phone (the candidate's phone number)\n\nOutput JSON:\n{\n  \"summary_short\": \"...\",\n  \"recommended_status\": \"shortlist|review|reject\",\n  \"name\": \"extracted name\",\n  \"email\": \"extracted email\",\n  \"phone\": \"extracted phone\"\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        3984,
        496
      ],
      "id": "148477fd-8c6a-4d1a-ba69-237daabe8dfb",
      "name": "Distiller Agent1"
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"summary_short\": \"Kandidat memiliki pengalaman kuat di frontend React namun kurang di .NET backend.\",\n  \"recommended_status\": \"review\",\n  \"name\": \"John Doe\",\n  \"email\": \"john@email.com\",\n  \"phone\": \"+6281234567890\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        4128,
        688
      ],
      "id": "4dffe01b-eabb-4a9c-8a6e-9882d352b962",
      "name": "Distilled Output1"
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        3968,
        688
      ],
      "id": "06895353-0f46-466b-a5ec-2cc29c0ccc16",
      "name": "LLM Distiller1",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"score\": 75,\n  \"must_match_pct\": 80,\n  \"nice_match_pct\": 60,\n  \"strengths\": [\"Strong React experience\", \"Good communication\"],\n  \"gaps\": [\"No .NET experience\"],\n  \"one_line_reason\": \"Strong frontend developer but lacks required backend skills\"\n}"
      },
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        3344,
        608
      ],
      "id": "091bd442-66c2-42a1-bd40-a30dff6b4205",
      "name": "Grade Parser1"
    },
    {
      "parameters": {
        "numberInputs": 3
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3,
      "position": [
        3552,
        480
      ],
      "id": "f509266d-d0c3-4abb-b5fc-104e5af7e075",
      "name": "Voting Merge1"
    },
    {
      "parameters": {
        "inputText": "={{ $json.concatenated_data }}",
        "categories": {
          "categories": [
            {
              "category": "Resume",
              "description": "Whether or not this document is a resume/CV"
            },
            {
              "category": "No Action Required",
              "description": "When the document is not a resume/CV"
            }
          ]
        },
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.textClassifier",
      "typeVersion": 1,
      "position": [
        2224,
        432
      ],
      "id": "34fd2b0b-8243-456d-9542-f9be0ba37fae",
      "name": "Classify Attachment1"
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        2224,
        624
      ],
      "id": "2a91dd05-8506-451e-b1de-107b1ae277b0",
      "name": "LLM Classifier1",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "fieldsToSummarize": {
          "values": [
            {
              "aggregation": "concatenate",
              "field": "data"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.summarize",
      "typeVersion": 1.1,
      "position": [
        2064,
        432
      ],
      "id": "8db4db0a-1093-4d38-9678-220b9665b398",
      "name": "Document Data1"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"data\": {{ JSON.stringify($json.text ?? $json.data) }}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1920,
        432
      ],
      "id": "5ba02997-90cb-49fc-b000-fffe5cb7e983",
      "name": "Extracted Data1"
    },
    {
      "parameters": {
        "operation": "pdf",
        "binaryPropertyName": "={{$json.fieldName}}",
        "options": {}
      },
      "type": "n8n-nodes-base.extractFromFile",
      "typeVersion": 1,
      "position": [
        1728,
        288
      ],
      "id": "e7d481a2-25f6-4c32-a613-b557bf57f507",
      "name": "PDF EXTRACTOR1"
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.mimeType }}",
                    "rightValue": "application/pdf",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "15fdf54a-f6ee-4225-abe1-2c8cfa14983f"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.mimeType }}",
                    "rightValue": "text/html",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "66e4c72a-28aa-437c-a40e-a8e76004fe45"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.mimeType }}",
                    "rightValue": "application/vnd.openxmlformats-officedocument.wordprocessingml.document",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "c7f8668c-a360-45ff-a415-b604670ec23b"
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        1536,
        432
      ],
      "id": "ecc07c01-9ba0-4796-b5d6-331cf683c4aa",
      "name": "Switch1"
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\nconst result = [];\n\nfor (const item of items) {\n  const binary = item.binary;\n  if (!binary) continue;\n\n  // Try to get email metadata if available\n  const json = item.json || {};\n  const senderEmail = json.from?.value?.[0]?.address || json.senderEmail || json.headers?.['from'] || '';\n  const senderName = json.from?.value?.[0]?.name || json.senderName || '';\n  const emailSubject = json.subject || json.emailSubject || '';\n\n  for (const key of Object.keys(binary)) {\n    const binaryData = binary[key];\n    result.push({\n      json: {\n        fileName: binaryData.fileName,\n        mimeType: binaryData.mimeType,\n        fileSize: binaryData.fileSize,\n        fileExtension: binaryData.fileExtension,\n        fieldName: key,\n        senderEmail,\n        senderName,\n        emailSubject\n      },\n      binary: { [key]: binaryData }\n    });\n  }\n}\n\nif (result.length === 0) {\n  throw new Error('No binary data found in the input');\n}\n\nreturn result;"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1360,
        432
      ],
      "id": "64d0bba7-2881-4282-9e7c-e5c1e1eedde2",
      "name": "Binary Extractor1"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"score\": {{ Math.round($json.output.map(item => item.score).reduce((a, b) => a + b, 0) / $json.output.length) }},\n  \"must_match_pct\": {{ Math.round($json.output.map(item => item.must_match_pct).reduce((a, b) => a + b, 0) / $json.output.length) }},\n  \"nice_match_pct\": {{ Math.round($json.output.map(item => item.nice_match_pct).reduce((a, b) => a + b, 0) / $json.output.length) }},\n  \"strengths\": {{ JSON.stringify([...new Set($json.output.flatMap(item => item.strengths))]) }},\n  \"gaps\": {{ JSON.stringify([...new Set($json.output.flatMap(item => item.gaps))]) }},\n  \"one_line_reason\": {{ JSON.stringify($json.output.map(item => item.one_line_reason).join(' | ')) }},\n  \"resumeData\": {{ JSON.stringify($('Prepare Grading1').item.json.resumeData) }},\n  \"individual_scores\": {{ JSON.stringify($json.output.map(function(item, i) { var models = ['GPT-4o', 'Claude Sonnet', 'Gemini Flash']; return Object.fromEntries([['model', models[i] || 'Model ' + (i+1)], ['score', item.score]]) })) }}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        3840,
        496
      ],
      "id": "81aa642c-cba1-4e54-8e0b-ca8676db86ce",
      "name": "Summary1"
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-flash",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        3072,
        688
      ],
      "id": "16a3fd32-3618-4a62-9f02-9107349d65d6",
      "name": "LLM Gemini1",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "model": "anthropic/claude-3.5-sonnet",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        3072,
        464
      ],
      "id": "7240c085-e9f6-460e-ad6e-0b51de7edc47",
      "name": "LLM Claude1",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "model": "openai/gpt-5-mini",
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        3168,
        112
      ],
      "id": "7a5c418b-7c5e-4e2c-9a25-65ad9d67d883",
      "name": "LLM GPT1",
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Extracted Resume: {{ $json.resumeData }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=You are tasked with grading a candidate based on the extracted resume data. Evaluate accurately on a scale from 0 to 100.\n\nInputs:\nJob Description: {{ $json.jobDescription }}\n\nPriority Parameters (importance scale 0-10):\n{{ (() => { try { const w = typeof $('Merge Config1').item.json.priorityWeights === 'string' ? JSON.parse($('Merge Config1').item.json.priorityWeights) : $('Merge Config1').item.json.priorityWeights; return Object.entries(w).map(([k,v]) => k + ': ' + v).join('\\n'); } catch(e) { return 'TechnicalSkills: 8\\nRelevantWorkExperience: 8\\nEducationalBackground: 3\\nCertifications: 1\\nLocationOrWorkAuth: 1'; } })() }}\n\nScoring Methodology:\n1. For each priority parameter, evaluate candidate 0-10\n2. Multiply raw score by priority weight\n3. Sum weighted scores, normalize to 0-100\n\nCalibration:\n* 90-100: Exceptional, exceeds all requirements\n* 75-89: Strong, meets essential + several nice-to-haves\n* 60-74: Qualified, meets most essential requirements\n* 40-59: Potential, missing several key requirements\n* Below 40: Not recommended\n\nIf the candidate's resume doesn't contain the rquired information at all/ missing crucial information to accurately assess their fit, please fill in 0.\n\nAlso provide:\n- must_match_pct: percentage of must-have requirements met\n- nice_match_pct: percentage of nice-to-have requirements met\n- strengths: array of candidate strengths\n- gaps: array of gaps/weaknesses\n- one_line_reason: single sentence summary\n\nOutput JSON:\n{\n  \"score\": 0,\n  \"must_match_pct\": 0,\n  \"nice_match_pct\": 0,\n  \"strengths\": [\"...\"],\n  \"gaps\": [\"...\"],\n  \"one_line_reason\": \"...\"\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        3072,
        848
      ],
      "id": "2b5c0178-723b-4a1b-99ae-808873423bf3",
      "name": "Gemini Resume Grader1",
      "retryOnFail": false,
      "maxTries": 5,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Extracted Resume: {{ $json.resumeData }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=You are tasked with grading a candidate based on the extracted resume data. Evaluate accurately on a scale from 0 to 100.\n\nInputs:\nJob Description: {{ $json.jobDescription }}\n\nPriority Parameters (importance scale 0-10):\n{{ (() => { try { const w = typeof $('Merge Config1').item.json.priorityWeights === 'string' ? JSON.parse($('Merge Config1').item.json.priorityWeights) : $('Merge Config1').item.json.priorityWeights; return Object.entries(w).map(([k,v]) => k + ': ' + v).join('\\n'); } catch(e) { return 'TechnicalSkills: 8\\nRelevantWorkExperience: 8\\nEducationalBackground: 3\\nCertifications: 1\\nLocationOrWorkAuth: 1'; } })() }}\n\nScoring Methodology:\n1. For each priority parameter, evaluate candidate 0-10\n2. Multiply raw score by priority weight\n3. Sum weighted scores, normalize to 0-100\n\nCalibration:\n* 90-100: Exceptional, exceeds all requirements\n* 75-89: Strong, meets essential + several nice-to-haves\n* 60-74: Qualified, meets most essential requirements\n* 40-59: Potential, missing several key requirements\n* Below 40: Not recommended\n\nIf the candidate's resume doesn't contain the rquired information at all/ missing crucial information to accurately assess their fit, please fill in 0.\n\nAlso provide:\n- must_match_pct: percentage of must-have requirements met\n- nice_match_pct: percentage of nice-to-have requirements met\n- strengths: array of candidate strengths\n- gaps: array of gaps/weaknesses\n- one_line_reason: single sentence summary\n\nOutput JSON:\n{\n  \"score\": 0,\n  \"must_match_pct\": 0,\n  \"nice_match_pct\": 0,\n  \"strengths\": [\"...\"],\n  \"gaps\": [\"...\"],\n  \"one_line_reason\": \"...\"\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        3072,
        576
      ],
      "id": "0640ab9d-27d0-4445-9ef9-9ef5a4610429",
      "name": "Anthropic Resume Grader1",
      "retryOnFail": false,
      "maxTries": 3,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Extracted Resume: {{ $json.resumeData }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "=You are tasked with grading a candidate based on the extracted resume data. Evaluate accurately on a scale from 0 to 100.\n\nInputs:\nJob Description: {{ $json.jobDescription }}\n\nPriority Parameters (importance scale 0-10):\n{{ (() => { try { const w = typeof $('Merge Config1').item.json.priorityWeights === 'string' ? JSON.parse($('Merge Config1').item.json.priorityWeights) : $('Merge Config1').item.json.priorityWeights; return Object.entries(w).map(([k,v]) => k + ': ' + v).join('\\n'); } catch(e) { return 'TechnicalSkills: 8\\nRelevantWorkExperience: 8\\nEducationalBackground: 3\\nCertifications: 1\\nLocationOrWorkAuth: 1'; } })() }}\n\nScoring Methodology:\n1. For each priority parameter, evaluate candidate 0-10\n2. Multiply raw score by priority weight\n3. Sum weighted scores, normalize to 0-100\n\nCalibration:\n* 90-100: Exceptional, exceeds all requirements\n* 75-89: Strong, meets essential + several nice-to-haves\n* 60-74: Qualified, meets most essential requirements\n* 40-59: Potential, missing several key requirements\n* Below 40: Not recommended\n\nAlso provide:\n- must_match_pct: percentage of must-have requirements met\n- nice_match_pct: percentage of nice-to-have requirements met\n- strengths: array of candidate strengths\n- gaps: array of gaps/weaknesses\n- one_line_reason: single sentence summary\n\nIf the candidate's resume doesn't contain the rquired information at all/ missing crucial information to accurately assess their fit, please fill in 0.\n\nOutput JSON:\n{\n  \"score\": 0,\n  \"must_match_pct\": 0,\n  \"nice_match_pct\": 0,\n  \"strengths\": [\"...\"],\n  \"gaps\": [\"...\"],\n  \"one_line_reason\": \"...\"\n}"
        }
      },
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.7,
      "position": [
        3072,
        272
      ],
      "id": "2fbadbc5-b025-458b-8954-5e40b707ab8c",
      "name": "OpenAI Resume Grader1",
      "retryOnFail": false,
      "maxTries": 5,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const merge = $items('Merge Config1')[0]?.json ?? {};\n\n// Build a single item with all needed data for the graders\nreturn [{\n  json: {\n    resumeData: merge.cvText,\n    jobDescription: merge.jobDescription,\n    priorityWeights: merge.priorityWeights,\n    roleName: merge.roleName,\n  }\n}];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        2832,
        432
      ],
      "id": "fd01c046-f8f7-417f-abd9-8e63c55d6c56",
      "name": "Prepare Grading1",
      "executeOnce": true,
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"cvText\": {{ JSON.stringify($('Document Data1').item.json.concatenated_data) }},\n  \"jobDescription\": {{ JSON.stringify($('Write JobTarget').item.json.JobDescription || '') }},\n  \"priorityWeights\": {{ JSON.stringify($('Write JobTarget').item.json.PriorityWeights || '{\"TechnicalSkills\":5,\"RelevantWorkExperience\":5,\"EducationalBackground\":5,\"Certifications\":5,\"LocationOrWorkAuth\":5}') }},\n  \"roleName\": {{ JSON.stringify($('Write JobTarget').item.json.RoleName || '') }},\n  \"fileName\": {{ JSON.stringify($('Binary Extractor1').item.json.fileName || '') }}\n}",
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        2672,
        432
      ],
      "id": "0ec9b737-d5db-403b-9520-7c7a9a242248",
      "name": "Merge Config1"
    },
    {
      "parameters": {},
      "type": "@n8n/n8n-nodes-langchain.toolCalculator",
      "typeVersion": 1,
      "position": [
        3376,
        832
      ],
      "id": "8b3f1bb4-ca24-4a06-9d5b-ac77b2874e03",
      "name": "Calculator"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.noOp",
      "typeVersion": 1,
      "position": [
        2496,
        624
      ],
      "id": "955173da-ed1a-40d9-a10a-b4401bf8aa20",
      "name": "No Action"
    },
    {
      "parameters": {
        "content": "## CekCV.Ai \u2014 Company (Batch Screening)\n\nWorkflow ini membantu perusahaan screening multiple CV secara otomatis dalam satu batch. Setiap CV dinilai oleh 3 AI model, dan hasilnya disimpan ke Google Sheets.\n\n   1. Kirim batch CV + job description (teks / LinkedIn URL) lewat Webhook \u2192 dapat `batchId`\n   2. Company JD di-extract & config disimpan ke Sheets\n   3. Loop setiap CV: extract, classify, validate, lalu scoring paralel (3 AI model)\n   4. AI Distiller rangkum profil kandidat, skor & data disimpan ke Candidates Sheet\n   5. Jika kandidat gagal diproses \u2192 skip & lanjut ke kandidat berikutnya (batch tetap jalan)\n   6. Setelah semua selesai \u2192 batch result di-compile dan status di-update\n\n### Error Handling\n- Per-kandidat: `Skip Failed Candidate` \u2014 kandidat error di-skip, batch lanjut\n- Batch-level: `Error: Update Company Status` \u2014 status error ditulis ke Sheets\n\n### Endpoints\n- **Submit Batch**: `POST /webhook/...` \u2192 returns `{ batchId }`\n- **Poll Status**: `POST /cekcv-poll-status` \u2192 works for both individual & batch",
        "height": 696,
        "width": 640,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -720,
        1136
      ],
      "id": "2d1f1e72-9afa-4379-b94f-e4eca0974acc",
      "name": "Sticky Note2"
    },
    {
      "parameters": {
        "content": "## CekCV.Ai \u2014 Individual\n\nWorkflow ini membantu individu mengecek kualitas CV mereka terhadap job description tertentu. Proses berjalan **async** \u2014 user langsung dapat `jobId` untuk polling status, sementara analisis berjalan di background.\n\n   1. Kirim CV + job description (teks / LinkedIn URL) lewat Webhook \u2192 langsung dapat `jobId`\n   2. AI analyze JD, extract & classify CV\n   3. 3 AI model (GPT, Claude, Gemini) scoring CV secara paralel (voting system)\n   4. AI Distiller rangkum profil, Advisor kasih improvement advice\n   5. AI generate improved CV (ATS-optimized)\n   6. Search params disimpan \u2192 frontend cari lowongan on-demand via Job Search Webhook\n   7. Semua hasil bisa di-poll via Status Poll Webhook (`cekcv-poll-status`)\n\n### Error Handling\nJika terjadi error di tahap manapun, status otomatis di-update ke Google Sheets dengan pesan error.\n\n### Endpoints\n- **Submit CV**: `POST /webhook/...` \u2192 returns `{ jobId }`\n- **Poll Status**: `POST /cekcv-poll-status` \u2192 returns current progress\n- **Job Search**: `POST /cekcv-search-jobs` \u2192 on-demand Apify search",
        "height": 696,
        "width": 640,
        "color": 6
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        -720,
        48
      ],
      "id": "933c5e4b-7127-4ae0-bb85-bf50763d4418",
      "name": "Sticky Note"
    },
    {
      "parameters": {
        "content": "### \ud83d\udd36 Stage 1: Input, Async Response & JD Analysis\n**Webhook** terima CV + job description (teks atau LinkedIn URL).\n- `Generate Job ID` \u2192 buat UUID unik untuk tracking async\n- `Init Job Status` \u2192 tulis row awal ke Google Sheets (status: \"processing\")\n- `Respond to Webhook Early` \u2192 langsung return `{ jobId }` ke user (non-blocking)\n- Jika **LinkedIn URL** \u2192 `Fetch LinkedIn Page` + AI extract JD dari HTML\n- Jika **plain text** \u2192 AI analyze JD langsung\n- AI generate **priority weights** dari JD untuk scoring\n- `Write JobTarget` \u2192 simpan JD + weights ke Google Sheets",
        "height": 800,
        "width": 1140,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        0,
        0
      ],
      "id": "2fd164af-c77b-4821-8f91-03ccc603d9f2",
      "name": "Process_Indv_1"
    },
    {
      "parameters": {
        "content": "### \ud83d\udfe2 Stage 2: CV Extraction & Classification\n- `Restore File Data` \u2192 re-attach binary data yang hilang setelah AI agent\n- `Binary Extractor` \u2192 ambil file dari webhook input\n- `Switch` \u2192 route ke **PDF Extractor** atau **HTML Extractor** berdasarkan file type\n- `Extracted Data` \u2192 normalize text output\n- `Document Data` \u2192 summarize dokumen\n- `Classify Attachment` (AI) \u2192 verifikasi apakah file memang CV/resume\n  - \u2705 CV valid \u2192 `Read JobTarget` + `Merge Config` (gabung JD weights + CV data)\n  - \u274c Bukan CV \u2192 `No Action` (stop)\n- `Status: Analyzing CV` \u2192 update progress di Sheets",
        "height": 498,
        "width": 1260,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1168,
        240
      ],
      "id": "735768a3-d365-48fc-ae3c-00d20788640e",
      "name": "Process_Indv_2"
    },
    {
      "parameters": {
        "content": "### \ud83d\udfe3 Stage 3: AI Scoring \u2014 3-Model Voting System\n- `Prepare Grading` \u2192 siapkan prompt + data untuk 3 grader\n- **3 AI Graders berjalan paralel**:\n  - `OpenAI Resume Grader` (GPT via OpenRouter)\n  - `Anthropic Resume Grader` (Claude via OpenRouter)\n  - `Gemini Resume Grader` (Gemini via OpenRouter)\n  - Masing-masing dilengkapi `Calculator` tool untuk komputasi skor\n- `Voting Merge` \u2192 gabung hasil 3 model\n- `Aggregate` \u2192 kumpulkan semua skor\n- `Summary` \u2192 rata-rata skor & compile results\n- `Distiller Agent` (AI) \u2192 rangkum profil kandidat secara natural language\n- `Status: Scoring Complete` \u2192 update progress di Sheets",
        "height": 972,
        "width": 1756,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2464,
        64
      ],
      "id": "9e255575-a28f-4da6-9fdf-012aec1b06b4",
      "name": "Process_Indv_3"
    },
    {
      "parameters": {
        "content": "### \ud83d\udd35 Stage 4: Improvement Advice, Resume Generation & Job Search\n**Improvement:**\n- `Resume Improvement Advisor` (AI) \u2192 analyze gap CV vs JD, kasih actionable advice\n- `Status: Improving` \u2192 update progress\n- `Generate Improved Resume` (AI) \u2192 buat CV baru yang ATS-optimized (HTML format)\n- `Status: Resume Generated` \u2192 update progress\n\n**Job Search (Deferred to Frontend):**\n- `Extract Job Search Params` (AI) \u2192 generate search query dari profil\n- `Save Search Params` \u2192 simpan params ke Sheets untuk frontend\n- `Bypass Job Search` \u2192 skip Apify (Run an Actor disabled), return empty jobs\n- `Merge Parallel Results` \u2192 gabung resume + jobs results\n\n**Error Handling:**\n- `Error Update Individual Status` \u2192 tangkap error, tulis ke Sheets\n- `Write Individual Error` \u2192 persist error message",
        "height": 798,
        "width": 1300,
        "color": 1
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        4240,
        -64
      ],
      "id": "4fab78e1-85ea-482f-b198-e4833bcd6066",
      "name": "Process_Indv_4"
    },
    {
      "parameters": {
        "content": "### \ud83d\udfe1 Stage 5: Output Compilation & Delivery\n- `Prepare Webhook Response` \u2192 compile semua hasil (scores, advice, improved CV, jobs)\n- `Create Resume File` \u2192 generate file CV baru (HTML)\n- `Log Improvements` \u2192 simpan improvement data ke Sheets\n- `Status: Complete` \u2192 finalize response data, trim large fields\n- `Write Complete Status` \u2192 update Sheets dengan status \"complete\" + full result JSON\n\nUser bisa poll hasil akhir via **Status Poll Webhook** (`cekcv-poll-status`).",
        "height": 306,
        "width": 1016,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        5632,
        128
      ],
      "id": "093e5216-1aef-4fad-b921-6710feb8ce31",
      "name": "Process_Indv_5"
    },
    {
      "parameters": {
        "content": "### \ud83d\udd36 Stage 1: Batch Intake, JD Extraction & CV Loop\n**Input Processing:**\n- `Webhook` terima batch CV + job description\n- `Parse Company Input` \u2192 extract JD, role name, buat `batchId`\n- Jika **LinkedIn URL** \u2192 `Fetch Company LinkedIn` + AI extract JD\n- `Write Company RoleConfig` \u2192 simpan JD + config ke Sheets\n- `Init Batch Status` \u2192 tulis status awal ke Sheets\n- `Respond to Company Webhook` \u2192 return `{ batchId }` (async)\n\n**Per-CV Processing Loop:**\n- `Restore Company Binary` \u2192 re-attach binary data\n- `Binary Extractor` \u2192 ambil file CV\n- `Loop Over Items` \u2192 proses setiap CV satu per satu\n- `Switch` \u2192 route ke PDF / HTML extractor\n- `Document Data` \u2192 summarize, `Classify Attachment` \u2192 verify CV\n- `Status: Analyzing Candidate` \u2192 update per-candidate progress\n\n**Batch Completion (after loop):**\n- `Read Batch Candidates` \u2192 baca semua kandidat dari Sheets\n- `Build Batch Result` \u2192 compile ranking & summary\n- `Status: Batch Complete` \u2192 update final batch status",
        "height": 584,
        "width": 1720,
        "color": 4
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        16,
        1168
      ],
      "id": "62929093-fe6f-4cda-a7ff-e3ef91253ae7",
      "name": "Process_Corp_1"
    },
    {
      "parameters": {
        "content": "### \ud83d\udfe2 Stage 2: Structured Data Extraction & Validation\n- `Merge Config` \u2192 gabung JD config + CV data\n- `Resume Data Extractor` (AI) \u2192 extract data CV secara structured (nama, email, skills, pengalaman, dll.)\n- `Evaluator` (AI) \u2192 cek akurasi & completeness hasil extraction\n  - Menggunakan `Eval Parser` untuk structured evaluation\n  - Jika extraction gagal / tidak akurat \u2192 **auto-retry** extraction\n- `Validation Check` \u2192 final gate sebelum scoring\n  - \u2705 Valid \u2192 lanjut ke Scoring\n  - \u274c Invalid \u2192 retry atau skip\n\n**Error Handling:** Jika extraction gagal total \u2192 `Skip Failed Candidate` (lanjut ke CV berikutnya)",
        "height": 664,
        "width": 920,
        "color": 2
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        1792,
        1248
      ],
      "id": "522cebde-525f-4424-96c3-63bdb633ef84",
      "name": "Process_Corp_2"
    },
    {
      "parameters": {
        "content": "### \ud83d\udfe3 Stage 3: AI Scoring (3-Model Voting) + Distillation\n- `Prepare Grading` \u2192 siapkan prompt + data\n- **3 AI Graders paralel** (sama seperti Individual):\n  - OpenAI (GPT), Anthropic (Claude), Gemini \u2014 via OpenRouter\n  - Masing-masing dengan `Calculator` tool\n- `Voting Merge` \u2192 gabung hasil, `Aggregate` \u2192 kumpulkan skor\n- `Summary` \u2192 compile & rata-rata skor\n- `Distiller Agent` (AI) \u2192 rangkum profil kandidat natural language\n  - Menggunakan `LLM AutoFix` sebagai fallback model jika distillation gagal\n\n**Error Handling (Per-Kandidat):**\n- `Skip Failed Candidate` \u2192 buat fallback record, lanjut loop\n- `Status: Skip Update` \u2192 update Sheets bahwa kandidat di-skip\n- Multiple error sources: Binary Extractor, Classify, Resume Extractor, Evaluator, Prepare Grading, Voting Merge, Summary, Aggregate, Append Sheet\n\n**Batch Error:**\n- `Error: Update Company Status` \u2192 update batch status ke error\n- `Write Company Error` \u2192 persist error ke Sheets",
        "height": 968,
        "width": 1520,
        "color": 5
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        2752,
        1072
      ],
      "id": "2f724be1-1a8b-491f-ac32-46e4adad3353",
      "name": "Process_Corp_3"
    },
    {
      "parameters": {
        "content": "### \ud83d\udd35 Stage 4: Candidate Data Storage\n- `Status: Scoring Candidate` \u2192 update progress bahwa scoring selesai untuk kandidat ini\n- `Append Candidates Sheet` \u2192 simpan semua data kandidat ke Google Sheets:\n  - Timestamp, Role, Nama, Email, Phone\n  - Skor dari 3 model + rata-rata\n  - AI Summary / Distilled profile\n  - Status (scored / skipped / error)\n- Setelah append \u2192 kembali ke `Loop Over Items` untuk proses CV berikutnya\n\n\u26a0\ufe0f **Note**: HR notification & interview scheduling belum diimplementasi di versi ini.",
        "height": 476,
        "width": 720,
        "color": 1
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        4288,
        1344
      ],
      "id": "19cf3859-a41b-4196-81be-33a30a80f089",
      "name": "Process_Corp_4"
    },
    {
      "parameters": {
        "content": "### \ud83d\udfe1 Stage 5: Reserved \u2014 Future Features\nArea ini disiapkan untuk fitur-fitur yang akan datang:\n- \ud83d\udd1c HR email notification untuk kandidat skor tinggi (>80/100)\n- \ud83d\udd1c Auto-schedule interview via Google Calendar\n- \ud83d\udd1c Email undangan interview ke kandidat\n\n**Saat ini**: Batch flow selesai di Stage 4 (Append Sheet \u2192 Loop \u2192 Batch Result).",
        "height": 658,
        "width": 1120,
        "color": 3
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        5056,
        1376
      ],
      "id": "90d58ada-b7e7-49f3-a6f3-4967aee22c9e",
      "name": "Process_Corp_5"
    },
    {
      "parameters": {
        "jsCode": "const item = $input.first();\nconst jobId = require('crypto').randomUUID();\nreturn [{\n  json: {\n    ...item.json,\n    jobId,\n    _jobType: 'individual'\n  },\n  binary: item.binary\n}];"
      },
      "id": "gen-jobid-001",
      "name": "Generate Job ID",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        240,
        144
      ]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $json.jobId }}",
            "batchId": "",
            "type": "individual",
            "status": "processing",
            "step": "started",
            "stepDescription": "Your CV analysis has started...",
            "progress": "0",
            "candidateIndex": "0",
            "totalCandidates": "1",
            "result": "",
            "error": "",
            "createdAt": "={{ new Date().toISOString() }}",
            "updatedAt": "={{ new Date().toISOString() }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "init-job-status-001",
      "name": "Init Job Status",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        432,
        144
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"jobId\": \"{{ $('Generate Job ID').item.json.jobId }}\",\n  \"status\": \"processing\",\n  \"message\": \"Your CV analysis has started. Poll for status updates.\"\n}",
        "options": {
          "responseCode": 202,
          "responseHeaders": {
            "entries": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        }
      },
      "id": "respond-early-001",
      "name": "Respond to Webhook Early",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        608,
        144
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $('Generate Job ID').first().json.jobId }}",
            "status": "processing",
            "step": "analyzing",
            "stepDescription": "AI is reading your CV and job description...",
            "progress": "20",
            "updatedAt": "={{ new Date().toISOString() }}"
          },
          "matchingColumns": [
            "jobId"
          ],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "status-analyzing-001",
      "name": "Status: Analyzing CV",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        2368,
        208
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $('Generate Job ID').first().json.jobId }}",
            "status": "processing",
            "step": "scoring_complete",
            "stepDescription": "3 AI models have scored your CV",
            "progress": "40",
            "updatedAt": "={{ new Date().toISOString() }}"
          },
          "matchingColumns": [
            "jobId"
          ],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "status-scoring-001",
      "name": "Status: Scoring Complete",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4000,
        704
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $('Generate Job ID').first().json.jobId }}",
            "status": "processing",
            "step": "improving",
            "stepDescription": "Generating improvement advice...",
            "progress": "60",
            "updatedAt": "={{ new Date().toISOString() }}"
          },
          "matchingColumns": [
            "jobId"
          ],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "status-improving-001",
      "name": "Status: Improving",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4496,
        0
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $('Generate Job ID').first().json.jobId }}",
            "status": "processing",
            "step": "resume_generated",
            "stepDescription": "Creating your improved CV...",
            "progress": "70",
            "updatedAt": "={{ new Date().toISOString() }}"
          },
          "matchingColumns": [
            "jobId"
          ],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "status-resume-gen-001",
      "name": "Status: Resume Generated",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4800,
        0
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $('Generate Job ID').first().json.jobId }}",
            "status": "processing",
            "step": "jobs_found",
            "stepDescription": "Found relevant jobs for you",
            "progress": "85",
            "updatedAt": "={{ new Date().toISOString() }}"
          },
          "matchingColumns": [
            "jobId"
          ],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "status-jobs-001",
      "name": "Status: Jobs Found",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        5600,
        0
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// Only process the first item to avoid duplicate Google Sheet writes\nif ($itemIndex > 0) return [];\n\nconst jobId = $('Generate Job ID').first().json.jobId;\nconst full = $('Prepare Webhook Response').first().json;\nconst trimmed = JSON.parse(JSON.stringify(full));\n\n// Trim improved_resume to save space\nif (trimmed.improved_resume) {\n  delete trimmed.improved_resume.text;\n  // Cap HTML to avoid exceeding Google Sheets cell limit\n  if (trimmed.improved_resume.html && trimmed.improved_resume.html.length > 30000) {\n    trimmed.improved_resume.html = trimmed.improved_resume.html.substring(0, 30000);\n  }\n}\n\n// Trim job data \u2014 keep only fields the frontend needs + rename relevance_score to match_score\nif (trimmed.recommended_jobs && Array.isArray(trimmed.recommended_jobs.jobs)) {\n  trimmed.recommended_jobs.jobs = trimmed.recommended_jobs.jobs.map(j => ({\n    title: j.title || '',\n    company: j.company || '',\n    location: j.location || '',\n    url: j.url || '',\n    match_score: j.relevance_score || j.match_score || 0,\n  }));\n}\n\nreturn [{\n  json: {\n    jobId,\n    status: 'complete',\n    step: 'complete',\n    stepDescription: 'Analysis complete!',\n    progress: 100,\n    result: JSON.stringify(trimmed),\n    updatedAt: new Date().toISOString()\n  }\n}];"
      },
      "id": "status-complete-001",
      "name": "Status: Complete",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        6464,
        0
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $json.jobId }}",
            "status": "={{ $json.status }}",
            "step": "={{ $json.step }}",
            "stepDescription": "={{ $json.stepDescription }}",
            "progress": "={{ $json.progress }}",
            "result": "={{ $json.result }}",
            "updatedAt": "={{ $json.updatedAt }}"
          },
          "matchingColumns": [
            "jobId"
          ],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "write-complete-001",
      "name": "Write Complete Status",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        6640,
        0
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const item = $input.first();\nconst body = item.json.body || item.json;\nconst batchId = require('crypto').randomUUID();\n\nconst jobDescription = (body.jobDescription || body.job_description || '').trim();\nconst roleName = (body.roleName || body.role_name || 'Untitled Role').trim();\nconst priorityWeights = body.priorityWeights || body.priority_weights\n  || '{\"TechnicalSkills\":5,\"RelevantWorkExperience\":5,\"EducationalBackground\":5,\"Certifications\":5,\"LocationOrWorkAuth\":5}';\nconst locale = (body.locale || 'id').trim();\n\nconst isLinkedIn = /linkedin\\.com\\/(jobs|job|posts|pulse|feed)/i.test(jobDescription);\n\nconst binary = item.binary || {};\nconst fileCount = Object.keys(binary).length;\n\nreturn [{\n  json: {\n    batchId,\n    jobDescription: isLinkedIn ? '' : jobDescription,\n    roleName,\n    priorityWeights: typeof priorityWeights === 'string' ? priorityWeights : JSON.stringify(priorityWeights),\n    totalFiles: fileCount,\n    _jobType: 'company',\n    hasLinkedIn: isLinkedIn,\n    linkedinUrl: isLinkedIn ? jobDescription : '',\n    locale\n  },\n  binary: item.binary\n}];"
      },
      "id": "parse-company-001",
      "name": "Parse Company Input",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        208,
        1312
      ]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "RoleConfig",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "RoleName": "={{ $json.roleName }}",
            "JobDescription": "={{ $json.jobDescription }}",
            "PriorityWeights": "={{ $json.priorityWeights }}",
            "Status": "active",
            "CreatedAt": "={{ new Date().toISOString() }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "RoleName",
              "displayName": "RoleName",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "write-roleconfig-001",
      "name": "Write Company RoleConfig",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        400,
        1312
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $('Parse Company Input').item.json.batchId }}",
            "batchId": "={{ $('Parse Company Input').item.json.batchId }}",
            "type": "company",
            "status": "processing",
            "step": "started",
            "stepDescription": "=Processing batch of {{ $('Parse Company Input').item.json.totalFiles }} CVs...",
            "progress": "0",
            "candidateIndex": "0",
            "totalCandidates": "={{ $('Parse Company Input').item.json.totalFiles }}",
            "result": "",
            "error": "",
            "createdAt": "={{ new Date().toISOString() }}",
            "updatedAt": "={{ new Date().toISOString() }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "init-batch-001",
      "name": "Init Batch Status",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        608,
        1312
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={\n  \"success\": true,\n  \"batchId\": \"{{ $('Parse Company Input').item.json.batchId }}\",\n  \"totalFiles\": {{ $('Parse Company Input').item.json.totalFiles }},\n  \"status\": \"processing\",\n  \"message\": \"CV batch processing started. Poll for status updates.\"\n}",
        "options": {
          "responseCode": 202,
          "responseHeaders": {
            "entries": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        }
      },
      "id": "respond-company-001",
      "name": "Respond to Company Webhook",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        800,
        1312
      ]
    },
    {
      "parameters": {
        "jsCode": "const webhookItem = $('Webhook').first();\nconst parsed = $('Parse Company Input').first().json;\nreturn [{\n  json: {\n    ...webhookItem.json,\n    ...parsed\n  },\n  binary: webhookItem.binary\n}];"
      },
      "id": "restore-binary-001",
      "name": "Restore Company Binary",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1008,
        1312
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $('Parse Company Input').first().json.batchId }}",
            "status": "processing",
            "step": "scoring",
            "stepDescription": "=Scoring candidate {{ $json.output.name || 'unknown' }}...",
            "progress": "={{ Math.round((($('Binary Extractor').item.json.itemIndex ?? 0) + 1) / ($('Parse Company Input').first().json.totalFiles || 1) * 90) }}",
            "updatedAt": "={{ new Date().toISOString() }}",
            "candidateIndex": "={{ $('Binary Extractor').item.json.itemIndex ?? 0 }}"
          },
          "matchingColumns": [
            "jobId"
          ],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "status-scoring-cand-001",
      "name": "Status: Scoring Candidate",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        4352,
        1712
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $('Parse Company Input').first().json.batchId }}",
            "status": "complete",
            "step": "complete",
            "stepDescription": "All candidates processed!",
            "progress": "100",
            "result": "={{ $json.result }}",
            "updatedAt": "={{ new Date().toISOString() }}"
          },
          "matchingColumns": [
            "jobId"
          ],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "status-batch-done-001",
      "name": "Status: Batch Complete",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        704,
        1552
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// Generic error handler for Company flow\nconst errorMsg = $input.first().json.error?.message\n  || $input.first().json.errorMessage\n  || 'An unexpected error occurred during batch processing';\n\nlet batchId = '';\ntry {\n  batchId = $('Parse Company Input').first().json.batchId;\n} catch(e) {\n  batchId = 'unknown';\n}\n\nreturn [{\n  json: {\n    jobId: batchId,\n    status: 'error',\n    step: 'error',\n    stepDescription: 'An error occurred during batch processing',\n    error: errorMsg,\n    progress: 0,\n    updatedAt: new Date().toISOString()\n  }\n}];"
      },
      "id": "error-handler-comp-001",
      "name": "Error: Update Company Status",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3504,
        1808
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $json.jobId }}",
            "status": "={{ $json.status }}",
            "step": "={{ $json.step }}",
            "stepDescription": "={{ $json.stepDescription }}",
            "error": "={{ $json.error }}",
            "progress": "={{ $json.progress }}",
            "updatedAt": "={{ $json.updatedAt }}"
          },
          "matchingColumns": [
            "jobId"
          ],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "write-error-comp-001",
      "name": "Write Company Error",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3712,
        1808
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "cekcv-poll-status",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "status-webhook-01",
      "name": "Status Poll Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        64,
        -416
      ],
      "webhookId": "d3adc463-b07e-4768-9a66-09db38a1ff91",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "const body = $input.first().json.body || $input.first().json || {};\nconst jobId = body.jobId || body.batchId || '';\n\nif (!jobId) {\n  return [{ json: { success: false, error: 'Missing jobId parameter' } }];\n}\n\nreturn [{ json: { jobId } }];"
      },
      "id": "status-lookup-01",
      "name": "Status Lookup",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        272,
        -416
      ]
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "jobId",
              "lookupValue": "={{ $('Status Lookup').first().json.jobId }}"
            }
          ]
        },
        "options": {
          "returnFirstMatch": true
        }
      },
      "id": "status-sheets-01",
      "name": "Read Job Status",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        480,
        -416
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const queryData = $('Status Lookup').first().json;\nconst row = $input.first().json;\n\nif (!row || !row.jobId) {\n  return [{ json: { success: false, error: 'Job not found', jobId: queryData.jobId || null } }];\n}\n\n// Defensive: if result is populated, the workflow completed even if status column wasn't updated\nconst hasResult = row.result && row.result.length > 10;\nconst effectiveStatus = hasResult ? 'complete' : (row.status || 'processing');\nconst effectiveStep = hasResult && row.status !== 'complete' ? 'complete' : (row.step || 'unknown');\nconst effectiveProgress = hasResult ? 100 : (parseInt(row.progress) || 0);\n\n// Detect stale/stuck jobs: if status is still 'processing' but updatedAt is > 5 minutes ago,\n// the n8n execution likely crashed or was canceled mid-way\nconst STALE_THRESHOLD_MS = 5 * 60 * 1000; // 5 minutes\nlet isStale = false;\nif (effectiveStatus === 'processing' && row.updatedAt) {\n  const lastUpdate = new Date(row.updatedAt).getTime();\n  const now = Date.now();\n  if (now - lastUpdate > STALE_THRESHOLD_MS) {\n    isStale = true;\n  }\n}\n\nconst response = {\n  success: true,\n  jobId: row.jobId,\n  batchId: row.batchId || null,\n  type: row.type || 'individual',\n  status: isStale ? 'error' : effectiveStatus,\n  step: isStale ? 'error' : effectiveStep,\n  stepDescription: isStale\n    ? 'Processing was interrupted. Please try again.'\n    : (hasResult && row.status !== 'complete' ? 'Analysis complete!' : (row.stepDescription || '')),\n  progress: effectiveProgress,\n  candidateIndex: parseInt(row.candidateIndex) || 0,\n  totalCandidates: parseInt(row.totalCandidates) || 1,\n  createdAt: row.createdAt || '',\n  updatedAt: row.updatedAt || '',\n  result: null,\n  error: isStale ? 'Processing was interrupted unexpectedly. This may be due to high AI load or a timeout. Please try again.' : null\n};\n\nif (effectiveStatus === 'complete' && row.result) {\n  try { response.result = JSON.parse(row.result); } catch(e) { response.result = row.result; }\n}\nif (row.status === 'error' && row.error) { response.error = row.error; }\n\nreturn [{ json: response }];"
      },
      "id": "status-format-01",
      "name": "Format Poll Response",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        672,
        -416
      ]
    },
    {
      "parameters": {
        "respondWith": "allIncomingItems",
        "options": {
          "responseCode": 200,
          "responseHeaders": {
            "entries": [
              {
                "name": "Content-Type",
                "value": "application/json"
              }
            ]
          }
        }
      },
      "id": "status-respond-01",
      "name": "Respond Poll Status",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        880,
        -416
      ]
    },
    {
      "parameters": {},
      "id": "merge-parallel-001",
      "name": "Merge Parallel Results",
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3,
      "position": [
        5600,
        400
      ]
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "cekcv-search-jobs",
        "responseMode": "responseNode",
        "options": {}
      },
      "id": "e8825ec5-a0c2-4fb4-a1dd-4a028eb08938",
      "name": "Job Search Webhook",
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        256,
        2000
      ],
      "webhookId": "d271fbf3-b00a-4c4f-aee9-667b99d71b7b",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "operation": "Run actor and get dataset",
        "actorId": "3fAlg6T4zBeu2Kgik",
        "customBody": "={\n  \"apifyProxyGroups\": \"RESIDENTIAL\",\n  \"keywords\": \n    {{ $json.keywords }}\n  ,\n  \"location\": \"{{ $json.location }}\",\n  \"maxItems\": \"{{ $json.maxItems }}\",\n  \"postingDateRange\": \"r604800\"\n}",
        "timeout": 300
      },
      "id": "d0f8d1b2-577a-43fe-87a1-44dacce54149",
      "name": "Job Search Apify",
      "type": "@apify/n8n-nodes-apify.apify",
      "typeVersion": 1,
      "position": [
        656,
        2000
      ],
      "credentials": {
        "apifyApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Apify"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "js-fmt-1",
              "name": "title",
              "type": "string",
              "value": "={{ $json.title || $json.jobTitle || 'Untitled' }}"
            },
            {
              "id": "js-fmt-2",
              "name": "company",
              "type": "string",
              "value": "={{ $json.companyName || $json.company || 'Unknown Company' }}"
            },
            {
              "id": "js-fmt-3",
              "name": "location",
              "type": "string",
              "value": "={{ $json.location || $json.jobLocation || '' }}"
            },
            {
              "id": "js-fmt-4",
              "name": "url",
              "type": "string",
              "value": "={{ $json.url || $json.link || $json.jobUrl || '' }}"
            }
          ]
        },
        "options": {}
      },
      "id": "da3448df-71b1-4120-8577-41302dc99d18",
      "name": "Job Search Format",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1056,
        2000
      ]
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "destinationFieldName": "jobs",
        "include": "allFieldsExcept",
        "options": {}
      },
      "id": "e03eec3e-5c73-4453-aba9-f2152c7bcf0c",
      "name": "Job Search Aggregate",
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        1456,
        2000
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "js-resp-1",
              "name": "success",
              "type": "boolean",
              "value": true
            },
            {
              "id": "js-resp-2",
              "name": "jobs",
              "type": "array",
              "value": "={{ $json.jobs }}"
            }
          ]
        },
        "options": {}
      },
      "id": "ed123191-8a4e-4c67-8c43-ad12a3b83e51",
      "name": "Job Search Build Response",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        1856,
        2000
      ]
    },
    {
      "parameters": {
        "respondWith": "json",
        "responseBody": "={{ JSON.stringify({ success: $json.success, jobs: (typeof $json.jobs === 'string' ? JSON.parse($json.jobs) : $json.jobs) }) }}",
        "options": {}
      },
      "id": "4b6e006d-415c-4dc2-91da-8170307844b9",
      "name": "Job Search Respond",
      "type": "n8n-nodes-base.respondToWebhook",
      "typeVersion": 1.1,
      "position": [
        2256,
        2000
      ]
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-flash",
        "options": {}
      },
      "id": "7b1fc6b4-fa1f-409e-bb7c-67c7fb225d34",
      "name": "LLM AutoFix",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        4176,
        1936
      ],
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $('Parse Company Input').first().json.batchId }}",
            "status": "processing",
            "step": "analyzing",
            "stepDescription": "=Analyzing candidate {{ $json.fileName || '' }}...",
            "progress": "={{ Math.round(($('Binary Extractor').item.json.itemIndex ?? 0) / ($('Parse Company Input').first().json.totalFiles || 1) * 90 + 90 / ($('Parse Company Input').first().json.totalFiles || 1) * 0.1) }}",
            "updatedAt": "={{ new Date().toISOString() }}",
            "candidateIndex": "={{ $('Binary Extractor').item.json.itemIndex ?? 0 }}"
          },
          "matchingColumns": [
            "jobId"
          ],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "5853c115-bf01-4aa5-92ec-664fef4fae45",
      "name": "Status: Analyzing Candidate",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        1712,
        1808
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "version": 2,
            "leftValue": "",
            "caseSensitive": true,
            "typeValidation": "strict"
          },
          "conditions": [
            {
              "id": "company-linkedin-check",
              "leftValue": "={{ $json.hasLinkedIn }}",
              "rightValue": "",
              "operator": {
                "type": "boolean",
                "operation": "true",
                "singleValue": true
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "id": "e656260c-0320-49e0-a46d-ecb345fafe4e",
      "name": "Is Company LinkedIn?",
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        192,
        960
      ]
    },
    {
      "parameters": {
        "url": "=https://r.jina.ai/{{ $json.linkedinUrl }}",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Accept",
              "value": "text/plain"
            },
            {
              "name": "X-Return-Format",
              "value": "text"
            }
          ]
        },
        "options": {
          "timeout": 30000
        }
      },
      "id": "ce8d54ea-2db8-4da0-8300-e814fb4cccf9",
      "name": "Fetch Company LinkedIn",
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        480,
        1104
      ]
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=Here is the content of a LinkedIn job posting page:\n\n{{ $json.data || $json.body || $json }}",
        "hasOutputParser": true,
        "options": {
          "systemMessage": "You are a job description extraction specialist.\n\nFrom the provided LinkedIn job posting content, extract:\n\n1. **roleName**: The exact job title\n2. **jobDescription**: The COMPLETE job description including responsibilities, requirements, qualifications, nice-to-haves, and benefits. Format as clean readable text, NOT HTML.\n3. **priorityWeights**: Based on the job requirements, assign weights (1-10) for: TechnicalSkills, RelevantWorkExperience, EducationalBackground, Certifications, LocationOrWorkAuth. Output as JSON string.\n\nOutput ONLY valid JSON. No markdown, no backticks."
        }
      },
      "id": "f79db568-101a-40f7-ab9c-7ded89996898",
      "name": "Extract Company JD",
      "type": "@n8n/n8n-nodes-langchain.agent",
      "typeVersion": 1.8,
      "position": [
        640,
        1104
      ]
    },
    {
      "parameters": {
        "model": "google/gemini-2.5-flash",
        "options": {}
      },
      "id": "002d1245-c6be-4771-a95b-c5fda633dc3b",
      "name": "LLM Company JD Extractor",
      "type": "@n8n/n8n-nodes-langchain.lmChatOpenRouter",
      "typeVersion": 1,
      "position": [
        640,
        1312
      ],
      "credentials": {
        "openRouterApi": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "OpenRouter account"
        }
      }
    },
    {
      "parameters": {
        "jsonSchemaExample": "{\n  \"roleName\": \"Senior Software Engineer\",\n  \"jobDescription\": \"We are looking for...\",\n  \"priorityWeights\": \"{\\\"TechnicalSkills\\\":8,\\\"RelevantWorkExperience\\\":8,\\\"EducationalBackground\\\":3,\\\"Certifications\\\":1,\\\"LocationOrWorkAuth\\\":1}\"\n}"
      },
      "id": "3d1959d4-5b2b-421a-9424-58c6d2b8b601",
      "name": "Company JD Parser",
      "type": "@n8n/n8n-nodes-langchain.outputParserStructured",
      "typeVersion": 1.2,
      "position": [
        800,
        1312
      ]
    },
    {
      "parameters": {
        "mode": "raw",
        "jsonOutput": "={\n  \"batchId\": {{ JSON.stringify($('Parse Company Input').item.json.batchId) }},\n  \"jobDescription\": {{ JSON.stringify($json.output.jobDescription || '') }},\n  \"roleName\": {{ JSON.stringify($json.output.roleName || $('Parse Company Input').item.json.roleName || 'Untitled Role') }},\n  \"priorityWeights\": {{ JSON.stringify($json.output.priorityWeights || $('Parse Company Input').item.json.priorityWeights || '{\"TechnicalSkills\":5,\"RelevantWorkExperience\":5,\"EducationalBackground\":5,\"Certifications\":5,\"LocationOrWorkAuth\":5}') }},\n  \"totalFiles\": {{ $('Parse Company Input').item.json.totalFiles }},\n  \"_jobType\": \"company\"\n}",
        "options": {}
      },
      "id": "2c8e8c1a-5d81-4817-94e2-d4fc580b3eba",
      "name": "Set Company JD from LinkedIn",
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        880,
        1104
      ]
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "Candidates",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "Source Email",
              "lookupValue": "={{ $('Parse Company Input').first().json.batchId }}"
            }
          ]
        },
        "options": {}
      },
      "id": "read-batch-candidates",
      "name": "Read Batch Candidates",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        464,
        1664
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "const items = $input.all();\nconst roleName = $('Parse Company Input').first().json.roleName || '';\nconst priorityWeights = $('Parse Company Input').first().json.priorityWeights || '{}';\nconst jobDescription = $('Write Company RoleConfig').first().json.JobDescription || $('Parse Company Input').first().json.jobDescription || '';\nlet weights = {};\ntry { weights = typeof priorityWeights === 'string' ? JSON.parse(priorityWeights) : priorityWeights; } catch(e) {}\n\nconst PLACEHOLDER_PATTERNS = [\n  /^data\\s+tidak/i,\n  /^tidak\\s+tersedia/i,\n  /^\\[.*kandidat.*\\]$/i,\n  /^\\[.*candidate.*\\]$/i,\n  /^\\[.*nama.*\\]$/i,\n  /^\\[.*name.*\\]$/i,\n  /^n\\/a$/i,\n  /^unknown$/i,\n  /^not\\s+available/i,\n  /^tidak\\s+diketahui/i,\n  /^candidate\\s+\\d+$/i,\n  /^kandidat\\s+\\d+$/i,\n];\n\nfunction isPlaceholderName(name) {\n  if (!name || name.trim().length === 0) return true;\n  return PLACEHOLDER_PATTERNS.some(p => p.test(name.trim()));\n}\n\nfunction cleanName(rawName, fileName) {\n  if (!isPlaceholderName(rawName)) return rawName.trim();\n  if (fileName) {\n    const base = fileName.replace(/\\.[^.]+$/, '').replace(/[_-]/g, ' ').replace(/\\s+/g, ' ').trim();\n    if (base.length > 2) return base;\n  }\n  return '';\n}\n\nconst candidates = items.map(item => {\n  const d = item.json;\n  let strengths = d['Strengths'] || '[]';\n  let gaps = d['Gaps'] || '[]';\n  try { strengths = JSON.parse(strengths); } catch(e) { strengths = []; }\n  try { gaps = JSON.parse(gaps); } catch(e) { gaps = []; }\n\n  let summaryText = d['Summary'] || '';\n  let oneLiner = '';\n  if (summaryText.includes('|||')) {\n    const parts = summaryText.split('|||');\n    summaryText = parts[0] || '';\n    oneLiner = parts[1] || '';\n  }\n\n  // Parse resume data from new column\n  let resume = null;\n  try {\n    const rawResume = d['Resume Data'];\n    if (rawResume && rawResume !== 'undefined' && rawResume !== 'null') {\n      resume = typeof rawResume === 'string' ? JSON.parse(rawResume) : rawResume;\n    }\n  } catch(e) { resume = null; }\n\n  // Parse individual scores from new column\n  let individualScores = [];\n  try {\n    const rawScores = d['Individual Scores'];\n    if (rawScores && rawScores !== 'undefined' && rawScores !== 'null') {\n      individualScores = typeof rawScores === 'string' ? JSON.parse(rawScores) : rawScores;\n    }\n  } catch(e) { individualScores = []; }\n\n  const rawName = d['Name'] || '';\n  const fileName = d['File Name'] || '';\n\n  return {\n    name: cleanName(rawName, fileName),\n    email: d['Email'] || '',\n    phone: (d['Phone'] || '').replace(/^'/, ''),\n    score: Number(d['Score']) || 0,\n    must_match_pct: Number(d['Must Match %']) || 0,\n    nice_match_pct: Number(d['Nice Match %']) || 0,\n    strengths: strengths,\n    gaps: gaps,\n    summary: summaryText,\n    oneLiner: oneLiner,\n    status: d['Status'] || 'review',\n    fileName: fileName,\n    weights: weights,\n    resume: resume,\n    individualScores: individualScores\n  };\n});\n\nconst seen = new Set();\nconst uniqueCandidates = candidates.filter(c => {\n  const key = c.fileName || c.email || c.name;\n  if (!key || seen.has(key)) return false;\n  seen.add(key);\n  return true;\n});\n\nconst scores = uniqueCandidates.map(c => c.score);\nconst avgScore = scores.length ? Math.round(scores.reduce((a,b) => a+b, 0) / scores.length) : 0;\nconst topScore = scores.length ? Math.max(...scores) : 0;\nconst lowScore = scores.length ? Math.min(...scores) : 0;\n\nconst gapCounts = {};\nuniqueCandidates.forEach(c => (c.gaps || []).forEach(g => { gapCounts[g] = (gapCounts[g] || 0) + 1; }));\nconst topGaps = Object.entries(gapCounts).sort((a,b) => b[1] - a[1]).slice(0, 3).map(([gap, count]) => ({ gap, count }));\n\nconst interviewReady = uniqueCandidates.filter(c => c.must_match_pct >= 80).length;\n\nreturn [{ json: { result: JSON.stringify({\n  roleName: roleName,\n  jobDescription: jobDescription,\n  candidates: uniqueCandidates,\n  insights: {\n    avgScore,\n    topScore,\n    lowScore,\n    scoreRange: topScore - lowScore,\n    interviewReady,\n    topGaps,\n    totalCandidates: uniqueCandidates.length,\n    shortlisted: uniqueCandidates.filter(c => c.status === 'shortlist').length,\n    review: uniqueCandidates.filter(c => c.status === 'review').length,\n    rejected: uniqueCandidates.filter(c => c.status === 'reject').length\n  }\n}) } }];"
      },
      "id": "build-batch-result",
      "name": "Build Batch Result",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        592,
        1664
      ]
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "15204e4c-076f-471d-8f94-289e198de1e2",
              "name": "apifyProxyGroups",
              "value": "RESIDENTIAL",
              "type": "string"
            },
            {
              "id": "68e96d80-dedb-4273-9409-d49e701482e7",
              "name": "keywords",
              "value": "={{ $json.output.Job_to_scrapes }}",
              "type": "array"
            },
            {
              "id": "eb5d3236-c791-4b6d-9084-bcd0d4b2a389",
              "name": "location",
              "value": "={{ $json.output.location || ($items('Summary1')[0].json.resumeData || '').match(/Jakarta|Surabaya|Bandung|Medan|Semarang|Makassar|Yogyakarta|Denpasar|Bali|Sydney|Melbourne|Brisbane|Perth|Adelaide|Singapore|Kuala Lumpur|London|New York|San Francisco|Tokyo|Hong Kong|Bangkok|Manila|Ho Chi Minh|Dubai|Berlin|Amsterdam|Toronto|Vancouver/i)?.[0] || '' }}",
              "type": "string"
            },
            {
              "id": "93540217-22af-421d-84fd-376e55bbebec",
              "name": "maxItems",
              "value": "={{ $json.output.limit ?? 20 }}",
              "type": "number"
            },
            {
              "id": "983b469b-43a2-41a0-af93-061bd130b92a",
              "name": "postingDateRange",
              "value": "r604800",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        5184,
        224
      ],
      "id": "c68cb60a-e285-4e64-892c-25668e3667de",
      "name": "Edit Fields",
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// Skip Apify job search \u2014 frontend will search on-demand\nconst params = $input.first().json;\nreturn [{\n  json: {\n    recommended_jobs: [],\n    total_jobs_found: 0,\n    search_query: (params.Job_to_scrapes || [])[0] || '',\n    search_location: params.location || '',\n    search_keywords: params.Job_to_scrapes || [],\n  }\n}];"
      },
      "id": "bypass-job-search-001",
      "name": "Bypass Job Search",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5632,
        224
      ]
    },
    {
      "parameters": {
        "operation": "append",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobSearchParams",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $('Init Job Status').first().json.jobId || '' }}",
            "keywords": "={{ JSON.stringify($json.keywords || []) }}",
            "location": "={{ $json.location || '' }}",
            "maxItems": "={{ $json.maxItems || 20 }}",
            "createdAt": "={{ new Date().toISOString() }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": false,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "save-search-params-001",
      "name": "Save Search Params",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        5408,
        80
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobSearchParams",
          "mode": "name"
        },
        "filtersUI": {
          "values": [
            {
              "lookupColumn": "jobId",
              "lookupValue": "={{ $json.body.jobId }}"
            }
          ]
        },
        "options": {}
      },
      "id": "read-search-params-001",
      "name": "Read Search Params",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        464,
        2000
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      },
      "onError": "continueRegularOutput"
    },
    {
      "parameters": {
        "jsCode": "// Generic error handler for Individual flow\nconst errorMsg = $input.first().json.error?.message\n  || $input.first().json.errorMessage\n  || 'An unexpected error occurred during CV analysis';\n\nlet jobId = '';\ntry {\n  jobId = $('Generate Job ID').first().json.jobId;\n} catch(e) {\n  jobId = 'unknown';\n}\n\nreturn [{\n  json: {\n    jobId,\n    status: 'error',\n    step: 'error',\n    stepDescription: 'An error occurred during analysis',\n    error: errorMsg,\n    progress: 0,\n    updatedAt: new Date().toISOString()\n  }\n}];"
      },
      "id": "error-handler-indv-001",
      "name": "Error Update Individual Status",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        5680,
        608
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $json.jobId }}",
            "status": "={{ $json.status }}",
            "step": "={{ $json.step }}",
            "stepDescription": "={{ $json.stepDescription }}",
            "error": "={{ $json.error }}",
            "progress": "={{ $json.progress }}",
            "updatedAt": "={{ $json.updatedAt }}"
          },
          "matchingColumns": [
            "jobId"
          ],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "write-error-indv-001",
      "name": "Write Individual Error",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        5888,
        608
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// When a candidate fails (LLM parse error, timeout, etc.), create a fallback\n// record and continue the loop instead of killing the entire batch.\nconst errorMsg = $input.first().json.error?.message\n  || $input.first().json.errorMessage\n  || $input.first().json.error\n  || 'Processing failed for this candidate';\n\nlet batchId = '';\nlet fileName = '';\nlet roleName = '';\ntry {\n  const parsed = $('Parse Company Input').first().json;\n  batchId = parsed.batchId || '';\n  roleName = parsed.roleName || '';\n} catch(e) {}\ntry {\n  const loopItem = $('Loop Over Items').first().json;\n  fileName = loopItem.fileName || loopItem.originalName || 'unknown';\n} catch(e) {}\n\nreturn [{\n  json: {\n    Timestamp: new Date().toISOString(),\n    Role: roleName,\n    Name: fileName.replace(/\\.pdf$/i, '').replace(/_/g, ' '),\n    Email: '',\n    Phone: '',\n    Score: 0,\n    'Must Match %': 0,\n    'Nice Match %': 0,\n    Strengths: '[]',\n    Gaps: JSON.stringify([errorMsg]),\n    Summary: 'Could not process this candidate: ' + errorMsg + '|||Error during processing',\n    Status: 'error',\n    'Source Email': batchId,\n    'File Name': fileName,\n    'Resume Data': '{}',\n    'Individual Scores': '[]'\n  }\n}];"
      },
      "id": "skip-failed-candidate-001",
      "name": "Skip Failed Candidate",
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        3504,
        2112
      ]
    },
    {
      "parameters": {
        "operation": "update",
        "documentId": {
          "__rl": true,
          "value": "1ntfZD2fwZhpmu3pwgAtD0zUVNfzLLiFg2XjMW82l7Nc",
          "mode": "id"
        },
        "sheetName": {
          "__rl": true,
          "value": "JobStatus",
          "mode": "name"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "jobId": "={{ $('Parse Company Input').first().json.batchId }}",
            "status": "processing",
            "step": "scoring",
            "stepDescription": "=Skipped candidate {{ $json.Name || 'unknown' }} (error), continuing...",
            "progress": "={{ Math.round((($('Binary Extractor').item.json.itemIndex ?? 0) + 1) / ($('Parse Company Input').first().json.totalFiles || 1) * 90) }}",
            "updatedAt": "={{ new Date().toISOString() }}",
            "candidateIndex": "={{ $('Binary Extractor').item.json.itemIndex ?? 0 }}"
          },
          "matchingColumns": [
            "jobId"
          ],
          "schema": [
            {
              "id": "jobId",
              "displayName": "jobId",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "canBeUsedToMatch": true
            }
          ]
        },
        "options": {}
      },
      "id": "status-skip-update-001",
      "name": "Status: Skip Update",
      "type": "n8n-nodes-base.googleSheets",
      "typeVersion": 4.7,
      "position": [
        3712,
        2112
      ],
      "credentials": {
        "googleSheetsOAuth2Api": {
          "id": "YOUR_CREDENTIAL_ID",
          "name": "Google Sheets account"
        }
      }
    },
    {
      "parameters": {
        "content": "### \ud83d\udd0d Job Search Webhook (On-Demand)\nEndpoint: `POST /cekcv-search-jobs`\n\nFrontend trigger search kapan saja setelah analisis selesai:\n- `Job Search Webhook` \u2192 terima request\n- `Read Search Params` \u2192 baca saved params dari Sheets\n- `Job Search Apify` \u2192 jalankan LinkedIn Jobs Scraper (Apify actor)\n- `Job Search Format` \u2192 format setiap job listing\n- `Job Search Aggregate` \u2192 kumpulkan semua results\n- `Job Search Build Response` \u2192 compile final response\n- `Job Search Respond` \u2192 return ke frontend\n\n\ud83d\udca1 Terpisah dari main flow: Apify search di-bypass di Individual flow (params disimpan, search on-demand).",
        "color": 6,
        "width": 980,
        "height": 300
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        208,
        1888
      ],
      "id": "job-search-sticky-note",
      "name": "Job Search Flow"
    },
    {
      "parameters": {
        "content": "### \u26a0\ufe0f Error Handler (Individual)\nJika terjadi error di `Restore File Data` atau `Prepare Webhook Response`:\n- `Error Update Individual Status` \u2192 format error message + jobId\n- `Write Individual Error` \u2192 update Google Sheets dengan status \"error\"\n\nUser akan melihat error status saat polling.",
        "color": 7,
        "width": 580,
        "height": 200
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        5600,
        548
      ],
      "id": "error-indv-sticky",
      "name": "Error Handler Individual"
    },
    {
      "parameters": {
        "content": "### \u26a0\ufe0f Error & Skip Handlers (Company)\n**Skip Failed Candidate** (per-kandidat error):\n- Sources: Binary Extractor, Classify, Resume Extractor, Evaluator, Prepare Grading, Voting, Summary, Aggregate, Append Sheet\n- Buat fallback record \u2192 `Status: Skip Update` \u2192 lanjut ke loop berikutnya\n\n**Batch Error** (fatal error):\n- `Error: Update Company Status` \u2192 format error + batchId\n- `Write Company Error` \u2192 update Sheets dengan status \"error\"",
        "color": 7,
        "width": 560,
        "height": 340
      },
      "type": "n8n-nodes-base.stickyNote",
      "typeVersion": 1,
      "position": [
        3440,
        1756
      ],
      "id": "error-corp-sticky",
      "name": "Error Handler Company"
    }
  ],
  "pinData": {
    "Webhook1": [
      {
        "json": {
          "headers": {
            "host": "charitably-paradigmatical-jayden.ngrok-free.dev",
            "user-agent": "node",
            "content-length": "284323",
            "accept": "*/*",
            "accept-encoding": "br, gzip, deflate",
            "accept-language": "*",
            "content-type": "multipart/form-data; boundary=----formdata-undici-041577483285",
            "ngrok-skip-browser-warning": "true",
            "sec-fetch-mode": "cors",
            "x-forwarded-for": "100.54.146.179",
            "x-forwarded-host": "charitably-paradigmatical-jayden.ngrok-free.dev",
            "x-forwarded-proto": "https",
            "x-invocation-id": "syd1::7c55z-1771977197693-903a4cb09d32",
            "x-vercel-id": "syd1::7c55z-1771977197693-903a4cb09d32"
          },
          "params": {},
          "query": {},
          "body": {
            "jobtarget": "About Pinnacle Investment Management\r\nPinnacle Investment Management Group Limited (ASX: PNI) is a leading Australian-based multi-affiliate investment management firm. Our mission is to establish, grow and support a diverse stable of world-class investment management firms.\u202f\r\nPinnacle currently consists of nineteen investment management firms that collectively manage over A$195billion in assets across a diverse range of asset classes.\u202fOur affiliated managers operate autonomously, in line with our philosophy that 'supported independence' is an essential ingredient in sustaining investment excellence and business resilience over the long term.\u202f\r\nOur values of Client Focus, Honesty and Integrity, Innovation and Empowerment guide all our actions. We continually invest in our people and develop them to help reach their potential through extensive on the job training.\r\nThis role will help build a growing sustainability function, directly contribute to Pinnacle\u2019s climate\u2011reporting and ESG capability, and gain early\u2011career exposure across corporate sustainability, responsible investing, supply\u2011chain sustainability and Affiliate\u2011support work. This is a dynamic role with real impact and room to grow.\r\nAbout The Role\r\nWe\u2019re looking for a motivated graduate to join Pinnacle\u2019s Sustainability team. This role will play a key part in strengthening our climate\u2011reporting capability, improving ESG processes, and supporting sustainability initiatives across Pinnacle and our Affiliates. You\u2019ll contribute to scalable reporting systems, climate\u2011data analysis, financed\u2011emissions methodology, supply\u2011chain sustainability work and broader ESG strategy execution.\r\nWhat You'll Do\r\nClimate & ESG Reporting\r\nSupport climate\u2011related disclosure readiness (ISSB/AASB S2/TCFD/CSRD) and sustainability reporting.\r\nAssist with financial and emissions\u2011related data analysis, including basic modelling to support scenario analysis inputs and financed\u2011emissions calculations.\r\nHelp build efficient, repeatable workflows, templates and data processes.\r\nSustainability Strategy & Process Improvement\r\nSupport development of scalable ESG tools, systems and reporting efficiencies.\r\nIdentify opportunities to innovate and streamline sustainability processes.\r\nHuman Rights, Modern Slavery & Supply\u2011Chain Sustainability\r\nContribute to modern slavery risk assessments, due\u2011diligence activities and supplier engagement.\r\nSupport development of supply\u2011chain sustainability documentation and processes.\r\nSocial & Corporate Initiatives\r\nSupport social programs including the Women & Allies Network and reconciliation initiatives.\r\nAffiliate Engagement & Research\r\nSupport Affiliates in keeping ahead of ESG and Responsible Investment expectations by monitoring emerging standards, market trends and regulatory shifts.\r\nDeliver clear guidance, insights and resources to help Affiliates meet rising sustainability requirements.\r\nWhat We Are Looking For\r\nDegree in Finance, Economics, Commerce, Sustainability, Environmental Science or similar.\r\nSome knowledge of climate science, sustainability reporting and/or responsible investing, gained through study (undergraduate or Masters) or early career exposure.\r\nBasic finance and modelling skills, with the ability to apply analytical thinking to climate\u2011related data and emissions work.\r\nStrong communication and collaboration skills.\r\nAbility to work autonomously, solve problems, and help build scalable processes.\r\nGlobal awareness or exposure to international sustainability standards is valued."
          },
          "webhookUrl": "https://charitably-paradigmatical-jayden.ngrok-free.dev/webhook/308876b5-b973-42b3-8dc7-d3c3925a5665",
          "executionMode": "production"
        },
        "binary": {
          "file": {
            "mimeType": "application/pdf",
            "fileType": "pdf",
            "fileExtension": "pdf",
            "data": "filesystem-v2",
            "fileName": "CV - Jesselyn Hasnah.pdf",
            "id": "filesystem-v2:workflows/sR7TyoST2KzCetW0/executions/temp/binary_data/3aab55dd-3525-4abb-9c56-a750dd35e904",
            "fileSize": "280 kB"
          }
        },
        "pairedItem": {
          "item": 0
        }
      }
    ]
  },
  "connections": {
    "Calculator1": {
      "ai_tool": [
        [
          {
            "node": "OpenAI Resume Grader",
            "type": "ai_tool",
            "index": 0
          },
          {
            "node": "Anthropic Resume Grader",
            "type": "ai_tool",
            "index": 0
          },
          {
            "node": "Gemini Resume Grader",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Merge Config": {
      "main": [
        [
          {
            "node": "Resume Data Extractor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resume Data Extractor": {
      "main": [
        [
          {
            "node": "Evaluator",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Skip Failed Candidate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Evaluator": {
      "main": [
        [
          {
            "node": "Validation Check",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Skip Failed Candidate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LLM Extractor": {
      "ai_languageModel": [
        [
          {
            "node": "Resume Data Extractor",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Resume Parser Output": {
      "ai_outputParser": [
        [
          {
            "node": "Resume Data Extractor",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "LLM Evaluator": {
      "ai_languageModel": [
        [
          {
            "node": "Evaluator",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Eval Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Evaluator",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Grading": {
      "main": [
        [
          {
            "node": "OpenAI Resume Grader",
            "type": "main",
            "index": 0
          },
          {
            "node": "Anthropic Resume Grader",
            "type": "main",
            "index": 0
          },
          {
            "node": "Gemini Resume Grader",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Skip Failed Candidate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "OpenAI Resume Grader": {
      "main": [
        [
          {
            "node": "Voting Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Anthropic Resume Grader": {
      "main": [
        [
          {
            "node": "Voting Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "Gemini Resume Grader": {
      "main": [
        [
          {
            "node": "Voting Merge",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "LLM GPT": {
      "ai_languageModel": [
        [
          {
            "node": "OpenAI Resume Grader",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "LLM Claude": {
      "ai_languageModel": [
        [
          {
            "node": "Anthropic Resume Grader",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "LLM Gemini": {
      "ai_languageModel": [
        [
          {
            "node": "Gemini Resume Grader",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Summary": {
      "main": [
        [
          {
            "node": "Distiller Agent",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Skip Failed Candidate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Binary Extractor": {
      "1": [
        [
          {
            "node": "Error: Update Company Status",
            "type": "1",
            "index": 0
          }
        ]
      ],
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "PDF EXTRACTOR",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTML EXTRACTOR",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PDF EXTRACTOR": {
      "main": [
        [
          {
            "node": "Extracted Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extracted Data": {
      "main": [
        [
          {
            "node": "Document Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Document Data": {
      "main": [
        [
          {
            "node": "Classify Attachment",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LLM Classifier": {
      "ai_languageModel": [
        [
          {
            "node": "Classify Attachment",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Classify Attachment": {
      "main": [
        [
          {
            "node": "Merge Config",
            "type": "main",
            "index": 0
          },
          {
            "node": "Status: Analyzing Candidate",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Skip Failed Candidate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Voting Merge": {
      "main": [
        [
          {
            "node": "Aggregate",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Skip Failed Candidate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Grade Parser": {
      "ai_outputParser": [
        [
          {
            "node": "OpenAI Resume Grader",
            "type": "ai_outputParser",
            "index": 0
          },
          {
            "node": "Anthropic Resume Grader",
            "type": "ai_outputParser",
            "index": 0
          },
          {
            "node": "Gemini Resume Grader",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "LLM Distiller": {
      "ai_languageModel": [
        [
          {
            "node": "Distiller Agent",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Distilled Output": {
      "ai_outputParser": [
        [
          {
            "node": "Distiller Agent",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Append Candidates Sheet": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Skip Failed Candidate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate": {
      "main": [
        [
          {
            "node": "Summary",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Skip Failed Candidate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML EXTRACTOR": {
      "main": [
        [
          {
            "node": "Extracted Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook1": {
      "main": [
        [
          {
            "node": "Parse Webhook Input1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Normalize Text JD": {
      "main": [
        [
          {
            "node": "Write JobTarget",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "JD Text Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Analyze JD from Text",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "LLM JD Text Analyzer": {
      "ai_languageModel": [
        [
          {
            "node": "Analyze JD from Text",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Analyze JD from Text": {
      "main": [
        [
          {
            "node": "Normalize Text JD",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read JobTarget": {
      "main": [
        [
          {
            "node": "Merge Config1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Write JobTarget": {
      "main": [
        [
          {
            "node": "Restore File Data",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Webhook Response": {
      "1": [
        [
          {
            "node": "Error Update Individual Status",
            "type": "1",
            "index": 0
          }
        ]
      ],
      "main": [
        [
          {
            "node": "Create Resume File",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Advisor Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Resume Improvement Advisor",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "LLM Advisor": {
      "ai_languageModel": [
        [
          {
            "node": "Resume Improvement Advisor",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Restore File Data": {
      "1": [
        [
          {
            "node": "Error Update Individual Status",
            "type": "1",
            "index": 0
          }
        ]
      ],
      "main": [
        [
          {
            "node": "Binary Extractor1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set JD from LinkedIn": {
      "main": [
        [
          {
            "node": "Write JobTarget",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "JD Output Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Extract JD from Page",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "LLM JD Extractor": {
      "ai_languageModel": [
        [
          {
            "node": "Extract JD from Page",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Extract JD from Page": {
      "main": [
        [
          {
            "node": "Set JD from LinkedIn",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch LinkedIn Page": {
      "main": [
        [
          {
            "node": "Extract JD from Page",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is LinkedIn URL?": {
      "main": [
        [
          {
            "node": "Fetch LinkedIn Page",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Analyze JD from Text",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LLM Resume Writer": {
      "ai_languageModel": [
        [
          {
            "node": "Generate Improved Resume",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Resume Writer Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Generate Improved Resume",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Run an Actor and get dataset": {
      "main": [
        [
          {
            "node": "Parse & Rank Jobs",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract Job Search Params": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LLM Job Search": {
      "ai_languageModel": [
        [
          {
            "node": "Extract Job Search Params",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Job Search Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Extract Job Search Params",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "HTML EXTRACTOR1": {
      "main": [
        [
          {
            "node": "Extracted Data1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Aggregate1": {
      "main": [
        [
          {
            "node": "Summary1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Distiller Agent1": {
      "main": [
        [
          {
            "node": "Resume Improvement Advisor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Distilled Output1": {
      "ai_outputParser": [
        [
          {
            "node": "Distiller Agent1",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "LLM Distiller1": {
      "ai_languageModel": [
        [
          {
            "node": "Distiller Agent1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Grade Parser1": {
      "ai_outputParser": [
        [
          {
            "node": "Gemini Resume Grader1",
            "type": "ai_outputParser",
            "index": 0
          },
          {
            "node": "Anthropic Resume Grader1",
            "type": "ai_outputParser",
            "index": 0
          },
          {
            "node": "OpenAI Resume Grader1",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Voting Merge1": {
      "main": [
        [
          {
            "node": "Aggregate1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Classify Attachment1": {
      "main": [
        [
          {
            "node": "Read JobTarget",
            "type": "main",
            "index": 0
          },
          {
            "node": "Status: Analyzing CV",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "No Action",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LLM Classifier1": {
      "ai_languageModel": [
        [
          {
            "node": "Classify Attachment1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Document Data1": {
      "main": [
        [
          {
            "node": "Classify Attachment1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extracted Data1": {
      "main": [
        [
          {
            "node": "Document Data1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PDF EXTRACTOR1": {
      "main": [
        [
          {
            "node": "Extracted Data1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch1": {
      "main": [
        [
          {
            "node": "PDF EXTRACTOR1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "HTML EXTRACTOR1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Extracted Data1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Binary Extractor1": {
      "main": [
        [
          {
            "node": "Switch1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LLM Gemini1": {
      "ai_languageModel": [
        [
          {
            "node": "Gemini Resume Grader1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "LLM Claude1": {
      "ai_languageModel": [
        [
          {
            "node": "Anthropic Resume Grader1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "LLM GPT1": {
      "ai_languageModel": [
        [
          {
            "node": "OpenAI Resume Grader1",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Gemini Resume Grader1": {
      "main": [
        [
          {
            "node": "Voting Merge1",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "Anthropic Resume Grader1": {
      "main": [
        [
          {
            "node": "Voting Merge1",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "OpenAI Resume Grader1": {
      "main": [
        [
          {
            "node": "Voting Merge1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare Grading1": {
      "main": [
        [
          {
            "node": "Gemini Resume Grader1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Anthropic Resume Grader1",
            "type": "main",
            "index": 0
          },
          {
            "node": "OpenAI Resume Grader1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Config1": {
      "main": [
        [
          {
            "node": "Prepare Grading1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Calculator": {
      "ai_tool": [
        [
          {
            "node": "Gemini Resume Grader1",
            "type": "ai_tool",
            "index": 0
          },
          {
            "node": "Anthropic Resume Grader1",
            "type": "ai_tool",
            "index": 0
          },
          {
            "node": "OpenAI Resume Grader1",
            "type": "ai_tool",
            "index": 0
          }
        ]
      ]
    },
    "Parse Webhook Input1": {
      "main": [
        [
          {
            "node": "Generate Job ID",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Respond to Webhook Early": {
      "main": [
        [
          {
            "node": "Is LinkedIn URL?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Log Improvements": {
      "main": [
        [
          {
            "node": "Status: Complete",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Status: Complete": {
      "main": [
        [
          {
            "node": "Write Complete Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Webhook": {
      "main": [
        [
          {
            "node": "Parse Company Input",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Write Company RoleConfig": {
      "main": [
        [
          {
            "node": "Init Batch Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Init Batch Status": {
      "main": [
        [
          {
            "node": "Respond to Company Webhook",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Respond to Company Webhook": {
      "main": [
        [
          {
            "node": "Restore Company Binary",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Restore Company Binary": {
      "1": [
        [
          {
            "node": "Error: Update Company Status",
            "type": "1",
            "index": 0
          }
        ]
      ],
      "main": [
        [
          {
            "node": "Binary Extractor",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Error: Update Company Status": {
      "main": [
        [
          {
            "node": "Write Company Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Job ID": {
      "main": [
        [
          {
            "node": "Respond to Webhook Early",
            "type": "main",
            "index": 0
          },
          {
            "node": "Init Job Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Summary1": {
      "main": [
        [
          {
            "node": "Distiller Agent1",
            "type": "main",
            "index": 0
          },
          {
            "node": "Status: Scoring Complete",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Resume Improvement Advisor": {
      "main": [
        [
          {
            "node": "Generate Improved Resume",
            "type": "main",
            "index": 0
          },
          {
            "node": "Status: Improving",
            "type": "main",
            "index": 0
          },
          {
            "node": "Extract Job Search Params",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Generate Improved Resume": {
      "main": [
        [
          {
            "node": "Status: Resume Generated",
            "type": "main",
            "index": 0
          },
          {
            "node": "Merge Parallel Results",
            "type": "0",
            "index": 0
          }
        ]
      ]
    },
    "Parse & Rank Jobs": {
      "main": [
        [
          {
            "node": "Status: Jobs Found",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Distiller Agent": {
      "main": [
        [
          {
            "node": "Status: Scoring Candidate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Status Poll Webhook": {
      "main": [
        [
          {
            "node": "Status Lookup",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Status Lookup": {
      "main": [
        [
          {
            "node": "Read Job Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read Job Status": {
      "main": [
        [
          {
            "node": "Format Poll Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Format Poll Response": {
      "main": [
        [
          {
            "node": "Respond Poll Status",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge Parallel Results": {
      "main": [
        [
          {
            "node": "Prepare Webhook Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Create Resume File": {
      "main": [
        [
          {
            "node": "Log Improvements",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Loop Over Items": {
      "main": [
        [
          {
            "node": "Read Batch Candidates",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "No Action1": {
      "main": [
        [
          {
            "node": "Loop Over Items",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Validation Check": {
      "main": [
        [
          {
            "node": "Prepare Grading",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Prepare Grading",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Job Search Apify": {
      "main": [
        [
          {
            "node": "Job Search Format",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Job Search Format": {
      "main": [
        [
          {
            "node": "Job Search Aggregate",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Job Search Aggregate": {
      "main": [
        [
          {
            "node": "Job Search Build Response",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Job Search Build Response": {
      "main": [
        [
          {
            "node": "Job Search Respond",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LLM AutoFix": {
      "ai_languageModel": [
        [
          {
            "node": "Distilled Output",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Status: Scoring Candidate": {
      "main": [
        [
          {
            "node": "Append Candidates Sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Parse Company Input": {
      "main": [
        [
          {
            "node": "Is Company LinkedIn?",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Is Company LinkedIn?": {
      "main": [
        [
          {
            "node": "Fetch Company LinkedIn",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Write Company RoleConfig",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Fetch Company LinkedIn": {
      "main": [
        [
          {
            "node": "Extract Company JD",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "LLM Company JD Extractor": {
      "ai_languageModel": [
        [
          {
            "node": "Extract Company JD",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "Company JD Parser": {
      "ai_outputParser": [
        [
          {
            "node": "Extract Company JD",
            "type": "ai_outputParser",
            "index": 0
          }
        ]
      ]
    },
    "Extract Company JD": {
      "main": [
        [
          {
            "node": "Set Company JD from LinkedIn",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Set Company JD from LinkedIn": {
      "main": [
        [
          {
            "node": "Write Company RoleConfig",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read Batch Candidates": {
      "main": [
        [
          {
            "node": "Build Batch Result",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Build Batch Result": {
      "main": [
        [
          {
            "node": "Status: Batch Complete",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "Run an Actor and get dataset",
            "type": "main",
            "index": 0
          },
          {
            "node": "Save Search Params",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Bypass Job Search": {
      "0": [
        [
          {
            "node": "Merge Parallel Results",
            "type": "1",
            "index": 0
          }
        ]
      ]
    },
    "Save Search Params": {
      "main": [
        [
          {
            "node": "Bypass Job Search",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Job Search Webhook": {
      "main": [
        [
          {
            "node": "Read Search Params",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Read Search Params": {
      "main": [
        [
          {
            "node": "Job Search Apify",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Error Update Individual Status": {
      "main": [
        [
          {
            "node": "Write Individual Error",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Skip Failed Candidate": {
      "main": [
        [
          {
            "node": "Status: Skip Update",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Status: Skip Update": {
      "main": [
        [
          {
            "node": "Append Candidates Sheet",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1",
    "availableInMCP": false,
    "callerPolicy": "workflowsFromSameOwner"
  },
  "versionId": "702031e7-5987-4ceb-816e-a7c777e76cac",
  "meta": {
    "instanceId": "75017dfd7331949a74ee6e3ab959be486d25d30cc49fd63cf118582d22dc1a9a"
  },
  "id": "sR7TyoST2KzCetW0",
  "tags": []
}